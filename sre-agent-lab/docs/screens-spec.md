# 画面仕様書

## 概要

本アプリケーションは5つの画面で構成されるSPA (Single Page Application) である。
CSSフレームワークとしてTailwind CSSを使用する。

---

## 画面一覧

| 画面名 | パス | 認証 | 説明 |
|---|---|---|---|
| ログイン | /login | 不要 (guestGuard) | メールアドレスとパスワードでログイン |
| ユーザー登録 | /register | 不要 (guestGuard) | 新規ユーザー登録 |
| ToDo一覧 | /todos | 必要 (authGuard) | ToDoの一覧表示・ステータス変更・フィルタリング |
| ToDo新規作成 | /todos/new | 必要 (authGuard) | 新しいToDoの作成 |
| ToDo詳細/編集 | /todos/:id | 必要 (authGuard) | ToDoの詳細表示・編集・削除 |

---

## 画面詳細

### 1. ログイン画面 (/login)

**レイアウト:**
- 画面中央にログインフォームを配置

**構成要素:**
- メールアドレス入力欄 (type=email, required)
- パスワード入力欄 (type=password, required)
- ログインボタン
- 「アカウントをお持ちでない方はこちら」リンク → /register
- エラーメッセージ表示エリア

**動作:**
- ログイン成功時: /todos にリダイレクト
- ログイン失敗時: エラーメッセージを表示
- 認証済みの場合: /todos にリダイレクト (guestGuard)

### 2. ユーザー登録画面 (/register)

**レイアウト:**
- 画面中央に登録フォームを配置

**構成要素:**
- 表示名入力欄 (type=text, optional)
- メールアドレス入力欄 (type=email, required)
- パスワード入力欄 (type=password, required, 8文字以上)
- 登録ボタン
- 「アカウントをお持ちの方はこちら」リンク → /login
- エラーメッセージ表示エリア

**動作:**
- 登録成功時: /login にリダイレクト (成功メッセージ付き)
- 登録失敗時: エラーメッセージを表示
- 認証済みの場合: /todos にリダイレクト (guestGuard)

### 3. ToDo一覧画面 (/todos)

**レイアウト:**
- ヘッダーバー: アプリ名、ユーザー表示名、ログアウトボタン
- フィルタセクション
- ToDoテーブル/リスト
- 新規作成ボタン

**ヘッダーバー:**
- アプリケーション名「SRE Agent Lab ToDo」
- ログインユーザーの表示名
- ログアウトボタン

**フィルタセクション:**
- タイトル検索 (テキスト入力、部分一致)
- ステータスフィルタ (ドロップダウン: すべて / 未着手 / 着手中 / 完了)
- 完了予定日範囲 (開始日・終了日のdate picker)
- クリアボタン

**ToDoテーブル:**

| 列 | 説明 | 操作 |
|---|---|---|
| タイトル | クリックで詳細画面へ遷移 | リンク |
| ステータス | ドロップダウンで即時変更可能 | PATCH /api/todos/{id}/status |
| 完了予定日 | 日付表示 | 参照のみ |
| 作成日時 | 日付表示 | 参照のみ |
| 完了日 | 日付表示 (完了時のみ) | 参照のみ |

**動作:**
- 初期表示: 全ToDoを取得して表示
- フィルタ入力/変更時: フィルタ条件でToDoを再取得
- ステータス変更時: APIを呼び出し、一覧を更新
- タイトルクリック時: /todos/:id に遷移
- 新規作成ボタン: /todos/new に遷移

### 4. ToDo新規作成画面 (/todos/new)

**レイアウト:**
- ヘッダーバー（一覧と共通）
- 作成フォーム

**構成要素:**
- タイトル入力欄 (type=text, required, 255文字以内)
- 本文入力欄 (textarea, optional)
- 完了予定日 (type=date, optional)
- ステータス表示: 「未着手」（固定、変更不可）
- 保存ボタン
- キャンセルボタン → /todos に戻る

**動作:**
- 保存成功時: /todos にリダイレクト
- 保存失敗時: エラーメッセージを表示

### 5. ToDo詳細/編集画面 (/todos/:id)

**レイアウト:**
- ヘッダーバー（一覧と共通）
- 編集フォーム
- 削除ボタン

**構成要素:**
- タイトル入力欄 (type=text, required, 255文字以内) - 編集可能
- 本文入力欄 (textarea) - 編集可能
- ステータスドロップダウン (未着手/着手中/完了) - 編集可能
- 完了予定日 (type=date) - 編集可能
- 作成日時 (テキスト表示) - **参照のみ**
- 完了日 (テキスト表示) - **参照のみ**
- 保存ボタン
- 一覧に戻るボタン → /todos
- 削除ボタン (赤色、確認ダイアログ付き)

**動作:**
- 初期表示: ToDo詳細をAPIから取得して表示
- 保存ボタン: PUT /api/todos/{id} を呼び出し、成功時に一覧へ遷移
- 削除ボタン: 確認ダイアログ表示 → OK時に DELETE /api/todos/{id} を呼び出し、一覧へ遷移
- 存在しないID: エラーメッセージを表示して一覧へ遷移

---

## ルートガード

### authGuard
- `sessionStorage` にJWTトークンが存在するか確認
- 存在しない場合: /login にリダイレクト

### guestGuard
- `sessionStorage` にJWTトークンが存在するか確認
- 存在する場合: /todos にリダイレクト

---

## レスポンシブ対応

- モバイルファースト設計
- テーブルはモバイルではカード形式で表示
- Tailwind CSSのブレークポイントで切り替え
