---
description: 指定されたファイルや機能のコードをセキュリティ・パフォーマンス・保守性の観点でレビューするプロンプト
mode: agent
tools:
  - read
  - search
  - usages
  - todo
---

# コードレビュー

指定されたコードを以下の観点で詳細にレビューし、改善提案を行ってください。

## レビュー対象

レビュー対象: ${{review_target}}

## レビュー観点と重大度

### 🚨 Critical（即座に修正必要）
- SQL インジェクション / XSS リスク
- 認証・認可の漏れ
- 秘匿情報のハードコード
- JWT トークン検証不備

### ⚠️ Major（次のリリースまでに修正）
- N+1 クエリ問題
- `AsNoTracking()` の欠落
- DI ライフタイムの不整合
- 単一責任の原則違反
- テストカバレッジ不足

### 💡 Minor（改善推奨）
- マジックナンバー・マジックストリング
- 構造化ログ未使用
- 命名規則の不一致
- `CancellationToken` 未伝播

## レビュー結果フォーマット

以下の形式で結果を出力してください：

```markdown
## 📋 コードレビュー結果

### 対象: {ファイルパス}

### 🚨 Critical
| # | 行 | 問題 | 修正案 |
|---|-----|------|--------|

### ⚠️ Major
| # | 行 | 問題 | 修正案 |
|---|-----|------|--------|

### 💡 Minor
| # | 行 | 問題 | 修正案 |
|---|-----|------|--------|

### ✅ Good Practices
- {良い実装パターンの記述}

### 📊 総合評価
{全体的な品質評価とサマリー}
```

## 注意事項
- 必ず **問題** と **具体的な修正案** をセットで提示
- 良い実装パターンも積極的にコメント
- 指摘は日本語で記述
