# 検証項目チェックリスト

> 最終更新: 2026-02-23 15:00:00 UTC  
> 総検証項目数: 24件

## 進捗サマリー

| ステータス | 件数 |
|-----------|------|
| 未着手 | 0 |
| 進行中 | 0 |
| 完了（脆弱性あり） | 13 |
| 完了（脆弱性なし） | 3 |
| 完了（判定不能） | 1 |
| スキップ | 7 |

## チェックリスト

| # | 検証ID | 脆弱性名 | CWE | カテゴリ | ツール | 推定重大度 | ステータス | 結果 | 備考 |
|---|--------|---------|-----|---------|--------|-----------|-----------|------|------|
| 1 | V-01 | SQLインジェクション（検索機能） | CWE-89 | インジェクション | sqlmap, curl | Critical (9.8) | 完了（脆弱性あり） | 脆弱性あり | エラーベースSQLi確認、詳細エラー・スタックトレース露出 |
| 2 | V-02 | SQLインジェクション（ログイン認証） | CWE-89 | インジェクション | sqlmap, curl | Critical (9.8) | 完了（脆弱性あり） | 脆弱性あり | 認証バイパス成功、' OR 1=1でログイン可能 |
| 3 | V-03 | SQLインジェクション（CRUD操作） | CWE-89 | インジェクション | curl | Critical (9.1) | 完了（脆弱性なし） | 脆弱性なし | IDパラメータに整数型バリデーションあり、SQLi不可 |
| 4 | V-04 | ディレクトリトラバーサル | CWE-22 | インジェクション | curl | High (8.6) | 完了（判定不能） | 判定不能 | /api/filesは存在するがファイルアクセス検証不可、profileImageUrlにペイロード保存は可 |
| 5 | V-05 | Mass Assignment（権限昇格） | CWE-915 | 認証・認可 | curl | Critical (9.1) | 完了（脆弱性あり） | 脆弱性あり | POST/PUTでroleフィールドを不正に設定可能、admin権限昇格可能 |
| 6 | V-06 | 認証チェック欠如（削除操作） | CWE-306 | 認証・認可 | curl | High (8.2) | 完了（脆弱性あり） | 脆弱性あり | 認証なしで任意ユーザーの削除が可能 |
| 7 | V-07 | パスワード平文保存・APIレスポンス露出 | CWE-256, CWE-200 | データ露出 | curl, psql | Critical (9.8) | 完了（脆弱性あり） | 脆弱性あり | パスワードが平文でDB保存、全APIレスポンスで露出 |
| 8 | V-08 | データベースポート外部公開 | CWE-668 | インフラ | psql | Critical (9.8) | 完了（脆弱性あり） | 脆弱性あり | ポート15432で外部公開、機密データ平文保存 |
| 9 | V-09 | XSS (Cross-Site Scripting) | CWE-79 | インジェクション | curl | High (7.1) | 完了（脆弱性あり） | 脆弱性あり | Stored XSS - XSSペイロードがサニタイズなしでDB保存 |
| 10 | V-10 | CORS設定の不備 | CWE-942 | 設定ミス | curl | Medium (6.5) | 完了（脆弱性あり） | 脆弱性あり | Access-Control-Allow-Origin: * - 任意Originからアクセス可 |
| 11 | V-11 | HTTPヘッダインジェクション | CWE-113 | インジェクション | curl | Medium (6.1) | 完了（脆弱性なし） | 脆弱性なし | CRLFインジェクション不可、フレームワークで保護 |
| 12 | V-12 | レート制限の欠如（ブルートフォース攻撃） | CWE-307 | 認証・認可 | curl | Medium (5.3) | 完了（脆弱性あり） | 脆弱性あり | レート制限なし、20回/0秒のログイン試行可能 |
| 13 | V-13 | オープンリダイレクト | CWE-601 | インジェクション | curl | Medium (5.4) | 完了（脆弱性なし） | 脆弱性なし | リダイレクト機能未実装 |
| 14 | V-14 | セキュリティヘッダ欠如（CSP） | CWE-693 | 設定ミス | curl | Medium (5.3) | 完了（脆弱性あり） | 脆弱性あり | CSP含む全セキュリティヘッダー未設定 |
| 15 | V-15 | 詳細エラーメッセージ露出 | CWE-209 | データ露出 | curl | Medium (4.3) | 完了（脆弱性あり） | 脆弱性あり | スタックトレース・ソースコードパス露出 |
| 16 | V-16 | サーバーバージョン情報露出 | CWE-200 | データ露出 | curl | Low (3.7) | 完了（脆弱性あり） | 脆弱性あり | Kestrel, nginx/1.29.5のバージョン露出 |
| 17 | V-17 | OWASP ZAP アクティブスキャン（総合検証） | 複数 | 総合 | OWASP ZAP アクティブスキャン | 可変 | 完了（脆弱性あり） | 脆弱性あり | High:6件, Medium:9件, Low:39件検出済み（zap-active-scan.md参照） |
| 18 | V-18 | GitHubトークン露出 | CWE-798 | データ露出 | Trivy | High (7.5) | スキップ | 明白 | ソースコード分析で確認済み |
| 19 | V-19 | 機密情報ハードコード | CWE-798 | データ露出 | ソースコード分析 | Medium (6.5) | スキップ | 明白 | ソースコード分析で確認済み |
| 20 | V-20 | コンテナroot実行 | CWE-250 | インフラ | Trivy | Medium (6.5) | スキップ | 明白 | Trivyで検出済み |
| 21 | V-21 | SSL/TLS未使用 | CWE-319 | 設定ミス | 情報収集 | Medium (5.9) | スキップ | 明白 | 設定ファイルで確認済み |
| 22 | V-22 | パスワードハードコード | CWE-798 | 設定ミス | ソースコード分析 | High (7.5) | スキップ | 明白 | 設定ファイルで確認済み |
| 23 | V-23 | 開発者例外ページ有効化 | CWE-209 | 設定ミス | curl | Medium (4.3) | スキップ | - | V-15に統合 |
| 24 | V-24 | CVE-2011-3192 | CVE-2011-3192 | コンポーネント | Nmap | なし | スキップ | 誤検知 | Apache専用CVE（nginx環境） |

## カテゴリ別進捗

| カテゴリ | 総数 | 未着手 | 進行中 | 完了（脆弱性あり） | 完了（脆弱性なし） | 完了（判定不能） | スキップ |
|---------|------|--------|--------|------------------|------------------|----------------|---------|
| インジェクション | 7 | 0 | 0 | 3 | 2 | 1 | 1 (V-23統合) |
| 認証・認可 | 3 | 0 | 0 | 3 | 0 | 0 | 0 |
| データ露出 | 6 | 0 | 0 | 3 | 0 | 0 | 3 (V-18,19,22) |
| 設定ミス | 5 | 0 | 0 | 3 | 0 | 0 | 2 (V-21,23) |
| インフラ | 2 | 0 | 0 | 1 | 0 | 0 | 1 (V-20) |
| 総合 | 1 | 0 | 0 | 1 | 0 | 0 | 0 |
| コンポーネント | 1 | 0 | 0 | 0 | 0 | 0 | 1 (V-24誤検知) |

## 重大度別進捗

| 重大度 | 総数 | 未着手 | 進行中 | 完了（脆弱性あり） | 完了（脆弱性なし） | 完了（判定不能） | スキップ |
|--------|------|--------|--------|------------------|------------------|----------------|---------|
| Critical | 5 | 0 | 0 | 5 | 0 | 0 | 0 |
| High | 5 | 0 | 0 | 2 | 0 | 1 | 2 (V-18,22) |
| Medium | 8 | 0 | 0 | 5 | 2 | 0 | 1 (V-21) |
| Low | 1 | 0 | 0 | 1 | 0 | 0 | 0 |
| 可変 | 1 | 0 | 0 | 1 | 0 | 0 | 0 |
| その他 | 4 | 0 | 0 | 0 | 1 | 0 | 3 (V-19,20,24) |

## 更新履歴

| 日時 | 検証ID | 操作 | 結果 |
|------|--------|------|------|
| 2026-02-23 15:00:00 UTC | - | チェックリスト作成 | 24件の検証項目を登録 |
| 2026-02-23 14:02:46 UTC | V-06 | 検証完了 | 脆弱性あり - 認証なしでユーザー削除可能 |
| 2026-02-23 14:03:28 UTC | V-05 | 検証完了 | 脆弱性あり - Mass Assignmentによるadmin権限昇格可能 |
| 2026-02-23 14:04:05 UTC | V-07 | 検証完了 | 脆弱性あり - パスワード平文保存・全APIで露出 |
| 2026-02-23 14:04:39 UTC | V-08 | 検証完了 | 脆弱性あり - DBポート15432で外部公開 |
| 2026-02-23 14:05:16 UTC | V-01 | 検証完了 | 脆弱性あり - SQLインジェクション（エラーベース）確認 |
| 2026-02-23 14:06:05 UTC | V-02 | 検証完了 | 脆弱性あり - 認証バイパス成功（SQLi） |
| 2026-02-23 14:06:45 UTC | V-03 | 検証完了 | 脆弱性なし - 整数型バリデーションあり |
| 2026-02-23 14:07:27 UTC | V-04 | 検証完了 | 判定不能 - ファイルアクセス機能の実装確認不可 |
| 2026-02-23 14:08:14 UTC | V-09 | 検証完了 | 脆弱性あり - Stored XSS確認 |
| 2026-02-23 14:08:57 UTC | V-10 | 検証完了 | 脆弱性あり - CORS wildcard設定 |
| 2026-02-23 14:09:42 UTC | V-11 | 検証完了 | 脆弱性なし - CRLFインジェクション不可 |
| 2026-02-23 14:09:42 UTC | V-12 | 検証完了 | 脆弱性あり - レート制限なし |
| 2026-02-23 14:09:42 UTC | V-13 | 検証完了 | 脆弱性なし - リダイレクト機能未実装 |
| 2026-02-23 14:10:33 UTC | V-14 | 検証完了 | 脆弱性あり - 全セキュリティヘッダー未設定 |
| 2026-02-23 14:10:33 UTC | V-15 | 検証完了 | 脆弱性あり - スタックトレース露出 |
| 2026-02-23 14:10:33 UTC | V-16 | 検証完了 | 脆弱性あり - サーバーバージョン露出 |
| 2026-02-23 14:00:51 UTC | V-17 | 検証完了 | 脆弱性あり - ZAPアクティブスキャン完了（99件検出） |

---

## 使用方法

### ステータス更新
検証実施後、以下のステータスに更新してください:

- **未着手**: 検証未実施
- **進行中**: 検証実行中
- **完了（脆弱性あり）**: 検証完了、脆弱性を確認
- **完了（脆弱性なし）**: 検証完了、脆弱性なし
- **スキップ**: 検証不要（明白な脆弱性、誤検知等）

### 結果記録
「結果」列には以下を記載:
- **脆弱性あり**: 検証で脆弱性を確認
- **脆弱性なし**: 脆弱性が存在しない、または適切に対策済み
- **明白**: ソースコード分析で明白に確認済み
- **誤検知**: ツールの誤検出
- **要追加調査**: 結果が不明瞭で追加調査が必要

### 備考欄
検証時の特記事項、追加情報、参照すべきレポートパス等を記載

---

## 検証実施順序（推奨）

### フェーズ1: 重大な認証・認可の問題
- [ ] V-06: 認証チェック欠如（削除操作）
- [ ] V-05: Mass Assignment（権限昇格）
- [ ] V-07: パスワード平文保存・APIレスポンス露出
- [ ] V-08: データベースポート外部公開

### フェーズ2: インジェクション系脆弱性
- [ ] V-01: SQLインジェクション（検索機能）
- [ ] V-02: SQLインジェクション（ログイン認証）
- [ ] V-03: SQLインジェクション（CRUD操作）
- [ ] V-04: ディレクトリトラバーサル

### フェーズ3: XSS・CSRF系
- [ ] V-09: XSS (Cross-Site Scripting)
- [ ] V-10: CORS設定の不備
- [ ] V-11: HTTPヘッダインジェクション

### フェーズ4: 認証・セッション管理
- [ ] V-12: レート制限の欠如（ブルートフォース攻撃）
- [ ] V-13: オープンリダイレクト

### フェーズ5: 設定ミス・情報漏洩
- [ ] V-14: セキュリティヘッダ欠如（CSP）
- [ ] V-15: 詳細エラーメッセージ露出
- [ ] V-16: サーバーバージョン情報露出

### フェーズ6: 総合スキャン
- [ ] V-17: OWASP ZAP アクティブスキャン（総合検証）

---

**チェックリスト作成者**: 検証項目決定エージェント (Verification Planning)  
**作成日時**: 2026-02-23 15:00:00 UTC  
**対象環境**: ローカルネットワーク内のDocker Compose環境  
**総検証項目数**: 24件（実施対象: 17件、スキップ: 7件）
