# 検証項目チェックリスト

> 最終更新: 2026年02月23日
> 総検証項目数: 20

---

## 進捗サマリー

| ステータス | 件数 |
|-----------|------|
| **未着手** | 0 |
| 進行中 | 0 |
| 完了（脆弱性あり） | 16 |
| 完了（脆弱性なし） | 4 |
| スキップ | 0 |

---

## チェックリスト

| # | 検証ID | 脆弱性名 | CWE | カテゴリ | ツール | 推定重大度 | ステータス | 結果 | 備考 |
|---|--------|---------|-----|---------|--------|-----------|-----------|------|------|
| 1 | V-01 | SQLインジェクション - ユーザー検索機能 | CWE-89 | インジェクション | sqlmap | Critical (9.8) | 完了 | ✅ 脆弱性確認済み | ' OR '1'='1 で全データ取得成功 |
| 2 | V-02 | SQLインジェクション - ユーザー詳細取得 | CWE-89 | インジェクション | sqlmap | Critical (9.8) | 完了 | ❌ 脆弱性なし | int型パラメータのため型安全 |
| 3 | V-03 | SQLインジェクション - ユーザー作成 | CWE-89 | インジェクション | sqlmap | Critical (9.8) | 完了 | ✅ 脆弱性確認済み | profileImageUrlでパスワード抽出成功 |
| 4 | V-04 | SQLインジェクション - ユーザー更新 | CWE-89 | インジェクション | sqlmap | Critical (9.8) | 完了 | ✅ 脆弱性確認済み | 全ユーザーの認証情報抽出成功 |
| 5 | V-05 | SQLインジェクション - ログイン認証バイパス | CWE-89 + CWE-287 | インジェクション | curl + sqlmap | Critical (10.0) | 完了 | ✅ 脆弱性確認済み | admin' OR '1'='1 で認証バイパス成功 |
| 6 | V-06 | 認証バイパス - DELETE操作 | CWE-862 | 認証・認可 | curl | Critical (9.1) | 完了 | ✅ 脆弱性確認済み | 認証なしでユーザー削除成功 |
| 7 | V-07 | Mass Assignment - 権限昇格 | CWE-915 | 認証・認可 | curl | High (8.1) | 完了 | ✅ 脆弱性確認済み | roleパラメータでadmin権限取得成功 |
| 8 | V-08 | Stored XSS - プロフィール画像URL | CWE-79 | インジェクション | curl + Playwright | Critical (9.0) | 完了 | ✅ 脆弱性確認済み | scriptタグがエスケープされずに保存 |
| 9 | V-09 | ディレクトリトラバーサル | CWE-22 | インフラ | curl | Critical (9.1) | 完了 | ❌ 脆弱性なし | Path.Combineが自動正規化 |
| 10 | V-10 | 安全でないデシリアライズ（RCE） | CWE-502 | インフラ | curl | Critical (10.0) | 完了 | ✅ 脆弱性確認済み | TypeNameHandling.All確認（ソース） |
| 11 | V-11 | HTTPヘッダインジェクション | CWE-113 | インジェクション | curl | Medium (6.5) | 完了 | ❌ 脆弱性なし | 近代的HTTPサーバーで自動防御 |
| 12 | V-12 | Open Redirect | CWE-601 | インフラ | curl + ブラウザ | Medium (6.1) | 完了 | ❌ 脆弱性なし | リダイレクト機能未実装 |
| 13 | V-13 | CORS設定の不備 | CWE-942 | 設定ミス | curl | Medium (5.3) | 完了 | ✅ 脆弱性確認済み | Access-Control-Allow-Origin: * |
| 14 | V-14 | データベースポート外部公開 | CWE-668 | インフラ | psql | Critical (9.8) | 完了 | ✅ 脆弱性確認済み | docker-compose.ymlで15432ポート公開設定あり（設定ミス） |
| 15 | V-15 | セキュリティヘッダーの欠如 | CWE-693 | 設定ミス | curl | Medium (5.3) | 完了 | ✅ 脆弱性確認済み | X-Frame-Options, CSP, HSTS等すべて欠如 |
| 16 | V-16 | サーバーバージョン情報漏洩 | CWE-200 | データ露出 | curl | Medium (5.3) | 完了 | ✅ 脆弱性確認済み | Server: Kestrel / nginx/1.29.5 |
| 17 | V-17 | 詳細エラー情報の露出 | CWE-209 | データ露出 | curl | Medium (5.3) | 完了 | ✅ 脆弱性確認済み | スタックトレース・ファイルパス露出 |
| 18 | V-18 | OWASP ZAP アクティブスキャン（包括的） | 複数 | 包括的検証 | OWASP ZAP アクティブスキャン | 可変 | 完了 | ✅ 脆弱性確認済み | 239件検出（High:17, Medium:19） |
| 19 | V-19 | レート制限の欠如 | CWE-307 | 設定ミス | curl (ループ) | Medium (5.3) | 完了 | ✅ 脆弱性確認済み | 20回連続試行すべて処理された |
| 20 | V-20 | SSL/TLS未使用（DB接続） | CWE-319 | 設定ミス | ソースコード確認 | High (7.4) | 完了 | ✅ 脆弱性確認済み | appsettings.jsonにSSL設定なし |

---

## 検証不要項目（明白な脆弱性）

| # | 脆弱性ID | 脆弱性名 | CWE | 理由 |
|---|---------|---------|-----|------|
| 1 | DATA-01 | パスワード平文保存 | CWE-256 | DBスキーマから明白 |
| 2 | DATA-02 | APIレスポンスにパスワード含む | CWE-200 | APIレスポンス仕様から明白 |
| 3 | DATA-03 | GitHub Token ハードコード | CWE-798 | Trivyで検出済み |
| 4 | DATA-04 | DB認証情報ハードコード | CWE-798 | ソースコードから明白 |
| 5 | AUTH-02 | 認証機構の完全欠如 | CWE-306 | ソースコードレビューで確認済み |
| 6 | COMP-01 | Dockerfile 非rootユーザー未指定 | CWE-250 | Trivyで検出済み |
| 7 | CONFIG-06 | 開発環境設定のまま | CWE-489 | docker-compose.ymlから明白 |
| 8 | INFRA-05 | 認証情報のlocalStorage保存 | CWE-311 | ソースコードから明白 |

---

## 誤検知項目（検証不要）

| # | 脆弱性ID | 検出内容 | ツール | 除外理由 |
|---|---------|---------|--------|---------|
| 1 | CONFIG-08 | CVE-2011-3192 (Apache Byterange DoS) | Nmap | nginx環境では該当しない（Apache固有脆弱性） |

---

## 更新履歴

| 日時 | 検証ID | 操作 | 結果 | 備考 |
|------|--------|------|------|------|
| 2026-02-23 | - | チェックリスト作成 | - | 工程5完了 |
| 2026-02-23 03:48 | V-14 | 検証完了 | ✅ 脆弱性確認済み | docker-compose.yml設定確認 |
| 2026-02-23 03:49 | V-20 | 検証完了 | ✅ 脆弱性確認済み | appsettings.json確認 |
| 2026-02-23 03:49 | V-15 | 検証完了 | ✅ 脆弱性確認済み | curl検証 |
| 2026-02-23 03:49 | V-16 | 検証完了 | ✅ 脆弱性確認済み | Serverヘッダー露出 |
| 2026-02-23 03:50 | V-05 | 検証完了 | ✅ 脆弱性確認済み | 認証バイパス成功 |
| 2026-02-23 03:50 | V-06 | 検証完了 | ✅ 脆弱性確認済み | 認証なし削除成功 |
| 2026-02-23 03:50 | V-07 | 検証完了 | ✅ 脆弱性確認済み | Mass Assignment成功 |
| 2026-02-23 03:50 | V-19 | 検証完了 | ✅ 脆弱性確認済み | レート制限なし |
| 2026-02-23 03:51 | V-01 | 検証完了 | ✅ 脆弱性確認済み | SQLインジェクション成功 |
| 2026-02-23 03:52 | V-02 | 検証完了 | ❌ 脆弱性なし | 型安全（False Positive） |
| 2026-02-23 03:52 | V-03 | 検証完了 | ✅ 脆弱性確認済み | データ抽出成功 |
| 2026-02-23 03:53 | V-04 | 検証完了 | ✅ 脆弱性確認済み | SQLインジェクション成功 |
| 2026-02-23 03:53 | V-08 | 検証完了 | ✅ 脆弱性確認済み | XSS保存成功 |
| 2026-02-23 03:54 | V-11 | 検証完了 | ❌ 脆弱性なし | False Positive |
| 2026-02-23 03:55 | V-09 | 検証完了 | ❌ 脆弱性なし | Path.Combine防御 |
| 2026-02-23 03:55 | V-10 | 検証完了 | ✅ 脆弱性確認済み | ソースコード確認 |
| 2026-02-23 03:56 | V-17 | 検証完了 | ✅ 脆弱性確認済み | エラー詳細露出 |
| 2026-02-23 03:56 | V-12 | 検証完了 | ❌ 脆弱性なし | 機能未実装 |
| 2026-02-23 03:56 | V-13 | 検証完了 | ✅ 脆弱性確認済み | CORS: * 設定 |
| 2026-02-23 03:57 | V-18 | 検証完了 | ✅ 脆弱性確認済み | ZAP 239件検出 |

---

## 検証実施順序（推奨）

### Phase 1: インフラ・ネットワーク層
1. V-14 (データベースポート外部公開)
2. V-20 (SSL/TLS未使用)
3. V-15 (セキュリティヘッダーの欠如)
4. V-16 (サーバーバージョン情報漏洩)

### Phase 2: 認証・認可
5. V-05 (SQLインジェクション - ログイン認証バイパス)
6. V-06 (認証バイパス - DELETE操作)
7. V-07 (Mass Assignment - 権限昇格)
8. V-19 (レート制限の欠如)

### Phase 3: インジェクション攻撃
9. V-01 (SQLインジェクション - ユーザー検索)
10. V-02 (SQLインジェクション - ユーザー詳細)
11. V-03 (SQLインジェクション - ユーザー作成)
12. V-04 (SQLインジェクション - ユーザー更新)
13. V-08 (Stored XSS)
14. V-11 (HTTPヘッダインジェクション)

### Phase 4: ファイル・データ操作
15. V-09 (ディレクトリトラバーサル)
16. V-10 (安全でないデシリアライズ)
17. V-17 (詳細エラー情報の露出)

### Phase 5: その他の設定ミス
18. V-12 (Open Redirect)
19. V-13 (CORS設定の不備)

### Phase 6: 包括的スキャン
20. V-18 (OWASP ZAP アクティブスキャン)

---

## 使用方法

### ステータス更新

検証を開始・完了したら、該当行のステータスを以下のように更新してください：

- **未着手** → **進行中** → **完了（脆弱性あり）** または **完了（脆弱性なし）**
- スキップする場合は **スキップ**

### 結果記入

- **脆弱性あり**: ✅ 脆弱性確認済み
- **脆弱性なし**: ❌ 脆弱性なし（False Positive）

### 備考欄

- 特記事項、追加調査が必要な項目、参照すべきログファイル等を記入

---

**チェックリスト作成完了**

工程6（検証フェーズ）では、このチェックリストを更新しながら検証を進めてください。
