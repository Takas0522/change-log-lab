# OWASP ZAP アクティブスキャン レポート

> 実施日時: 2026-02-23 03:45:22
> 実施方法: ZAP Proxy + Playwright E2E テスト → アクティブスキャン

## 1. 実施概要

| 項目 | 値 |
|------|-----|
| 収集URL数 | 133 |
| 対象ホスト | api:5000, frontend |
| Playwright テスト | 72 passed (5.4m) |
| 通信収集フェーズ検出数 | 149 |
| アクティブスキャン新規検出数 | 90 |
| **合計アラート数** | **239** |

## 2. リスクレベル別サマリー

### 全体サマリー

| リスク | 合計 | パッシブ検出 | アクティブ新規 | 主な検出項目 |
|--------|------|--------------|----------------|-------------|
| **High** | **17** | 0 | **17** | SQL Injection - PostgreSQL |
| **Medium** | **19** | 19 | **0** | Missing Anti-clickjacking Header, Content Security Policy (CSP) Header Not Set, Cross-Domain Misconfiguration |
| Low | 100 | 99 | 1 | Cookie設定、ヘッダー不足等 |
| Informational | 103 | 31 | 72 | 情報開示、フィンガープリント |

### High リスクアラート内訳

| アラート名 | 件数 |
|-----------|------|
| SQL Injection - PostgreSQL | 17 |

### Medium リスクアラート内訳

| アラート名 | 件数 |
|-----------|------|
| CSP: Failure to Define Directive with No Fallback | 3 |
| CSP: Wildcard Directive | 3 |
| CSP: style-src unsafe-inline | 3 |
| CSP: script-src unsafe-eval | 3 |
| Missing Anti-clickjacking Header | 2 |
| Content Security Policy (CSP) Header Not Set | 2 |
| Sub Resource Integrity Attribute Missing | 2 |
| Cross-Domain Misconfiguration | 1 |

## 3. 検出アラート詳細

### 3.1 High リスクアラート


#### 1. SQL Injection - PostgreSQL

- **リスク**: High
- **信頼度**: Medium
- **URL**: `http://frontend/api/users`
- **パラメータ**: `username`
- **攻撃ベクタ**: `'`
- **証拠**: `syntax error at or near`
- **説明**: SQL injection may be possible.
- **対策**: Do not trust client side input, even if there is client side validation in place.
In general, type check all data on the server side.
If the application uses JDBC, use PreparedStatement or CallableSta
- **CWE ID**: 89
- **WASC ID**: 19


#### 2. SQL Injection - PostgreSQL

- **リスク**: High
- **信頼度**: Medium
- **URL**: `http://frontend/api/login`
- **パラメータ**: `username`
- **攻撃ベクタ**: `'`
- **証拠**: `syntax error at or near`
- **説明**: SQL injection may be possible.
- **対策**: Do not trust client side input, even if there is client side validation in place.
In general, type check all data on the server side.
If the application uses JDBC, use PreparedStatement or CallableSta
- **CWE ID**: 89
- **WASC ID**: 19


#### 3. SQL Injection - PostgreSQL

- **リスク**: High
- **信頼度**: Medium
- **URL**: `http://frontend/api/login`
- **パラメータ**: `password`
- **攻撃ベクタ**: `'`
- **証拠**: `unterminated quoted string at or near`
- **説明**: SQL injection may be possible.
- **対策**: Do not trust client side input, even if there is client side validation in place.
In general, type check all data on the server side.
If the application uses JDBC, use PreparedStatement or CallableSta
- **CWE ID**: 89
- **WASC ID**: 19


#### 4. SQL Injection - PostgreSQL

- **リスク**: High
- **信頼度**: Medium
- **URL**: `http://frontend/api/users`
- **パラメータ**: `email`
- **攻撃ベクタ**: `'`
- **証拠**: `syntax error at or near`
- **説明**: SQL injection may be possible.
- **対策**: Do not trust client side input, even if there is client side validation in place.
In general, type check all data on the server side.
If the application uses JDBC, use PreparedStatement or CallableSta
- **CWE ID**: 89
- **WASC ID**: 19


#### 5. SQL Injection - PostgreSQL

- **リスク**: High
- **信頼度**: Medium
- **URL**: `http://frontend/api/users`
- **パラメータ**: `password`
- **攻撃ベクタ**: `'`
- **証拠**: `syntax error at or near`
- **説明**: SQL injection may be possible.
- **対策**: Do not trust client side input, even if there is client side validation in place.
In general, type check all data on the server side.
If the application uses JDBC, use PreparedStatement or CallableSta
- **CWE ID**: 89
- **WASC ID**: 19


#### 6. SQL Injection - PostgreSQL

- **リスク**: High
- **信頼度**: Medium
- **URL**: `http://frontend/api/users`
- **パラメータ**: `role`
- **攻撃ベクタ**: `'`
- **証拠**: `syntax error at or near`
- **説明**: SQL injection may be possible.
- **対策**: Do not trust client side input, even if there is client side validation in place.
In general, type check all data on the server side.
If the application uses JDBC, use PreparedStatement or CallableSta
- **CWE ID**: 89
- **WASC ID**: 19


#### 7. SQL Injection - PostgreSQL

- **リスク**: High
- **信頼度**: Medium
- **URL**: `http://frontend/api/users`
- **パラメータ**: `role`
- **攻撃ベクタ**: `'`
- **証拠**: `unterminated quoted string at or near`
- **説明**: SQL injection may be possible.
- **対策**: Do not trust client side input, even if there is client side validation in place.
In general, type check all data on the server side.
If the application uses JDBC, use PreparedStatement or CallableSta
- **CWE ID**: 89
- **WASC ID**: 19


#### 8. SQL Injection - PostgreSQL

- **リスク**: High
- **信頼度**: Medium
- **URL**: `http://frontend/api/users`
- **パラメータ**: `profileImageUrl`
- **攻撃ベクタ**: `'`
- **証拠**: `unterminated quoted string at or near`
- **説明**: SQL injection may be possible.
- **対策**: Do not trust client side input, even if there is client side validation in place.
In general, type check all data on the server side.
If the application uses JDBC, use PreparedStatement or CallableSta
- **CWE ID**: 89
- **WASC ID**: 19


#### 9. SQL Injection - PostgreSQL

- **リスク**: High
- **信頼度**: Medium
- **URL**: `http://frontend/api/users?search=%27%28`
- **パラメータ**: `search`
- **攻撃ベクタ**: `'(`
- **証拠**: `syntax error at or near`
- **説明**: SQL injection may be possible.
- **対策**: Do not trust client side input, even if there is client side validation in place.
In general, type check all data on the server side.
If the application uses JDBC, use PreparedStatement or CallableSta
- **CWE ID**: 89
- **WASC ID**: 19


#### 10. SQL Injection - PostgreSQL

- **リスク**: High
- **信頼度**: Medium
- **URL**: `http://api:5000/api/login`
- **パラメータ**: `username`
- **攻撃ベクタ**: `'`
- **証拠**: `syntax error at or near`
- **説明**: SQL injection may be possible.
- **対策**: Do not trust client side input, even if there is client side validation in place.
In general, type check all data on the server side.
If the application uses JDBC, use PreparedStatement or CallableSta
- **CWE ID**: 89
- **WASC ID**: 19


#### 11. SQL Injection - PostgreSQL

- **リスク**: High
- **信頼度**: Medium
- **URL**: `http://api:5000/api/users`
- **パラメータ**: `username`
- **攻撃ベクタ**: `'`
- **証拠**: `syntax error at or near`
- **説明**: SQL injection may be possible.
- **対策**: Do not trust client side input, even if there is client side validation in place.
In general, type check all data on the server side.
If the application uses JDBC, use PreparedStatement or CallableSta
- **CWE ID**: 89
- **WASC ID**: 19


#### 12. SQL Injection - PostgreSQL

- **リスク**: High
- **信頼度**: Medium
- **URL**: `http://api:5000/api/users`
- **パラメータ**: `email`
- **攻撃ベクタ**: `'`
- **証拠**: `syntax error at or near`
- **説明**: SQL injection may be possible.
- **対策**: Do not trust client side input, even if there is client side validation in place.
In general, type check all data on the server side.
If the application uses JDBC, use PreparedStatement or CallableSta
- **CWE ID**: 89
- **WASC ID**: 19


#### 13. SQL Injection - PostgreSQL

- **リスク**: High
- **信頼度**: Medium
- **URL**: `http://api:5000/api/login`
- **パラメータ**: `password`
- **攻撃ベクタ**: `'`
- **証拠**: `unterminated quoted string at or near`
- **説明**: SQL injection may be possible.
- **対策**: Do not trust client side input, even if there is client side validation in place.
In general, type check all data on the server side.
If the application uses JDBC, use PreparedStatement or CallableSta
- **CWE ID**: 89
- **WASC ID**: 19


#### 14. SQL Injection - PostgreSQL

- **リスク**: High
- **信頼度**: Medium
- **URL**: `http://api:5000/api/users`
- **パラメータ**: `password`
- **攻撃ベクタ**: `'`
- **証拠**: `syntax error at or near`
- **説明**: SQL injection may be possible.
- **対策**: Do not trust client side input, even if there is client side validation in place.
In general, type check all data on the server side.
If the application uses JDBC, use PreparedStatement or CallableSta
- **CWE ID**: 89
- **WASC ID**: 19


#### 15. SQL Injection - PostgreSQL

- **リスク**: High
- **信頼度**: Medium
- **URL**: `http://api:5000/api/users`
- **パラメータ**: `role`
- **攻撃ベクタ**: `'`
- **証拠**: `unterminated quoted string at or near`
- **説明**: SQL injection may be possible.
- **対策**: Do not trust client side input, even if there is client side validation in place.
In general, type check all data on the server side.
If the application uses JDBC, use PreparedStatement or CallableSta
- **CWE ID**: 89
- **WASC ID**: 19


#### 16. SQL Injection - PostgreSQL

- **リスク**: High
- **信頼度**: Medium
- **URL**: `http://api:5000/api/users`
- **パラメータ**: `profileImageUrl`
- **攻撃ベクタ**: `'`
- **証拠**: `unterminated quoted string at or near`
- **説明**: SQL injection may be possible.
- **対策**: Do not trust client side input, even if there is client side validation in place.
In general, type check all data on the server side.
If the application uses JDBC, use PreparedStatement or CallableSta
- **CWE ID**: 89
- **WASC ID**: 19


#### 17. SQL Injection - PostgreSQL

- **リスク**: High
- **信頼度**: Medium
- **URL**: `http://api:5000/api/users?search=%27%28`
- **パラメータ**: `search`
- **攻撃ベクタ**: `'(`
- **証拠**: `syntax error at or near`
- **説明**: SQL injection may be possible.
- **対策**: Do not trust client side input, even if there is client side validation in place.
In general, type check all data on the server side.
If the application uses JDBC, use PreparedStatement or CallableSta
- **CWE ID**: 89
- **WASC ID**: 19


### 3.2 Medium リスクアラート


#### 1. Missing Anti-clickjacking Header

- **URL**: `http://frontend/`
- **パラメータ**: `x-frame-options`
- **説明**: The response does not protect against 'ClickJacking' attacks. It should include either Content-Security-Policy with 'frame-ancestors' directive or X-Frame-Options.
- **対策**: Modern Web browsers support the Content-Security-Policy and X-Frame-Options HTTP headers. Ensure one of them is set on all web pages returned by your 


#### 2. Content Security Policy (CSP) Header Not Set

- **URL**: `http://frontend/`
- **パラメータ**: ``
- **説明**: Content Security Policy (CSP) is an added layer of security that helps to detect and mitigate certain types of attacks, including Cross Site Scripting (XSS) and data injection attacks. These attacks a
- **対策**: Ensure that your web server, application server, load balancer, etc. is configured to set the Content-Security-Policy header.


#### 3. Missing Anti-clickjacking Header

- **URL**: `http://frontend/login`
- **パラメータ**: `x-frame-options`
- **説明**: The response does not protect against 'ClickJacking' attacks. It should include either Content-Security-Policy with 'frame-ancestors' directive or X-Frame-Options.
- **対策**: Modern Web browsers support the Content-Security-Policy and X-Frame-Options HTTP headers. Ensure one of them is set on all web pages returned by your 


#### 4. Content Security Policy (CSP) Header Not Set

- **URL**: `http://frontend/login`
- **パラメータ**: ``
- **説明**: Content Security Policy (CSP) is an added layer of security that helps to detect and mitigate certain types of attacks, including Cross Site Scripting (XSS) and data injection attacks. These attacks a
- **対策**: Ensure that your web server, application server, load balancer, etc. is configured to set the Content-Security-Policy header.


#### 5. Cross-Domain Misconfiguration

- **URL**: `http://frontend/api/users`
- **パラメータ**: ``
- **説明**: Web browser data loading may be possible, due to a Cross Origin Resource Sharing (CORS) misconfiguration on the web server.
- **対策**: Ensure that sensitive data is not available in an unauthenticated manner (using IP address white-listing, for instance).
Configure the "Access-Control


#### 6. Sub Resource Integrity Attribute Missing

- **URL**: `https://www.google.com/`
- **パラメータ**: ``
- **説明**: The integrity attribute is missing on a script or link tag served by an external server. The integrity tag prevents an attacker who have gained access to this server from injecting a malicious content
- **対策**: Provide a valid integrity attribute to the tag.


#### 7. Sub Resource Integrity Attribute Missing

- **URL**: `https://www.google.com/`
- **パラメータ**: ``
- **説明**: The integrity attribute is missing on a script or link tag served by an external server. The integrity tag prevents an attacker who have gained access to this server from injecting a malicious content
- **対策**: Provide a valid integrity attribute to the tag.


#### 8. CSP: Failure to Define Directive with No Fallback

- **URL**: `https://www.google.com/gen_204?s=webhp&t=aft&atyp=csi&ei=9MubafKvGp-H4dUPy8vS6AY&rt=wsrt.1025,hst.43,prt.176,aft.176&folr=_9MubafKvGp-H4dUPy8vS6AY_7&imn=9&dtc=140&stc=22&ima=0&imad=0&imac=0&wh=720&nt=navigate&dt=&ts=191588&nhp=http/1.1&ant=push&opi=89978449`
- **パラメータ**: `Content-Security-Policy`
- **説明**: The Content Security Policy fails to define one of the directives that has no fallback. Missing/excluding them is the same as allowing anything.
- **対策**: Ensure that your web server, application server, load balancer, etc. is properly configured to set the Content-Security-Policy header.


#### 9. CSP: Wildcard Directive

- **URL**: `https://www.google.com/gen_204?s=webhp&t=aft&atyp=csi&ei=9MubafKvGp-H4dUPy8vS6AY&rt=wsrt.1025,hst.43,prt.176,aft.176&folr=_9MubafKvGp-H4dUPy8vS6AY_7&imn=9&dtc=140&stc=22&ima=0&imad=0&imac=0&wh=720&nt=navigate&dt=&ts=191588&nhp=http/1.1&ant=push&opi=89978449`
- **パラメータ**: `Content-Security-Policy`
- **説明**: Content Security Policy (CSP) is an added layer of security that helps to detect and mitigate certain types of attacks. Including (but not limited to) Cross Site Scripting (XSS), and data injection at
- **対策**: Ensure that your web server, application server, load balancer, etc. is properly configured to set the Content-Security-Policy header.


#### 10. CSP: style-src unsafe-inline

- **URL**: `https://www.google.com/gen_204?s=webhp&t=aft&atyp=csi&ei=9MubafKvGp-H4dUPy8vS6AY&rt=wsrt.1025,hst.43,prt.176,aft.176&folr=_9MubafKvGp-H4dUPy8vS6AY_7&imn=9&dtc=140&stc=22&ima=0&imad=0&imac=0&wh=720&nt=navigate&dt=&ts=191588&nhp=http/1.1&ant=push&opi=89978449`
- **パラメータ**: `Content-Security-Policy`
- **説明**: Content Security Policy (CSP) is an added layer of security that helps to detect and mitigate certain types of attacks. Including (but not limited to) Cross Site Scripting (XSS), and data injection at
- **対策**: Ensure that your web server, application server, load balancer, etc. is properly configured to set the Content-Security-Policy header.


### 3.3 Low / Informational アラート

Low リスク: 100 件（Cookie設定、ヘッダー不足等）
Informational: 103 件（情報開示、バージョン検出等）

詳細は JSON レポートを参照してください。

## 4. 収集URL一覧（対象ホストのみ）

- http://api:5000
- http://api:5000/api
- http://api:5000/api/Controllers
- http://api:5000/api/Controllers/UsersController.cs
- http://api:5000/api/appsettings.Development.json
- http://api:5000/api/appsettings.json
- http://api:5000/api/files
- http://api:5000/api/files/..
- http://api:5000/api/files/..%252Fappsettings.json
- http://api:5000/api/files/..%2Fappsettings.json
- http://api:5000/api/files/....
- http://api:5000/api/files/..../....
- http://api:5000/api/files/..../..../etc
- http://api:5000/api/files/....//....//etc/passwd
- http://api:5000/api/import
- http://api:5000/api/login
- http://api:5000/api/users
- http://api:5000/api/users/-1
- http://api:5000/api/users/9999
- http://api:5000/api/users?search=test%27%20AND%20SLEEP(1)%20--
- http://api:5000/etc
- http://api:5000/etc/passwd
- http://frontend
- http://frontend/
- http://frontend/?redirect=https%3A%2F%2Fexample.com
- http://frontend/?search=test
- http://frontend/api
- http://frontend/api/users
- http://frontend/api/users/1
- http://frontend/api/users/9999
- http://frontend/assets
- http://frontend/assets/index-BaaSrhE0.js
- http://frontend/assets/index-DQ3P1g1z.css
- http://frontend/login
- http://frontend/nonexistent-page
- http://frontend/users
- http://frontend/users/1
- http://frontend/users/1/edit
- http://frontend/users/9999
- http://frontend/users/new


## 5. Playwright E2E テスト結果

```
72 passed (5.4m)
```

## 6. 出力ファイル

| ファイル | パス | サイズ |
|---------|------|--------|
| ZAP HTML レポート | `/reports/zap-active/zap-active-report.html` | 503.9 KB |
| ZAP JSON レポート | `/reports/zap-active/zap-active-report.json` | 243.7 KB |
| 全アラート JSON | `/reports/zap-active/all-alerts.json` | 529.8 KB |
| パッシブアラート JSON | `/reports/zap-active/passive-alerts.json` | 379.9 KB |
| 収集URL JSON | `/reports/zap-active/collected-urls.json` | 37.2 KB |


## 7. 推奨される次のアクション

### 7.1 緊急対応が必要な脆弱性（High リスク: 17件）

- **SQL Injection - PostgreSQL**: 詳細は上記セクション 3.1 を参照


### 7.2 優先度の高い改善項目（Medium リスク: 19件）

- **Sub Resource Integrity Attribute Missing**: セキュリティヘッダーの追加、設定の見直し等
- **CSP: Failure to Define Directive with No Fallback**: セキュリティヘッダーの追加、設定の見直し等
- **CSP: script-src unsafe-eval**: セキュリティヘッダーの追加、設定の見直し等
- **Content Security Policy (CSP) Header Not Set**: セキュリティヘッダーの追加、設定の見直し等
- **CSP: style-src unsafe-inline**: セキュリティヘッダーの追加、設定の見直し等


### 7.3 継続的なセキュリティテスト

- CI/CD パイプラインへの ZAP スキャン統合
- 定期的なペネトレーションテストの実施
- セキュリティ教育の強化

---

**レポート生成日時**: 2026-02-23 03:45:22
**スキャンツール**: OWASP ZAP 2.16.1 + Playwright E2E
