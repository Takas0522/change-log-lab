# OWASP ZAP ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¹ã‚­ãƒ£ãƒ³ ãƒ¬ãƒãƒ¼ãƒˆ

> å®Ÿæ–½æ—¥æ™‚: 2026-02-23 14:00:51
> å®Ÿæ–½æ–¹æ³•: ZAP Proxy + Playwright E2E ãƒ†ã‚¹ãƒˆ

## 1. å®Ÿæ–½æ¦‚è¦

| é …ç›® | å€¤ |
|------|-----|
| åé›†URLæ•° | 96 |
| Playwright ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«æ•° | 8 |
| é€šä¿¡åé›†ãƒ•ã‚§ãƒ¼ã‚ºæ¤œå‡ºæ•° | 59 |
| ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¹ã‚­ãƒ£ãƒ³æ¤œå‡ºæ•° | 99 |
| åˆè¨ˆã‚¢ãƒ©ãƒ¼ãƒˆæ•° | 99 |

## 2. ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«åˆ¥ã‚µãƒãƒªãƒ¼

| ãƒªã‚¹ã‚¯ | ä»¶æ•° | ä¸»ãªæ¤œå‡ºé …ç›® |
|--------|------|-------------|
| High | 6 | SQL Injection |
| Medium | 9 | CSP Header Not Set, Missing Anti-clickjacking Header |
| Low | 39 | Cookie without SameSite, Server Leaks Info |
| Informational | 45 | User Controllable HTML Element, Re-examine Cache |

## 3. æ¤œå‡ºã‚¢ãƒ©ãƒ¼ãƒˆè©³ç´°

### High ãƒªã‚¹ã‚¯

#### SQL Injection

**ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«**: High  
**ä¿¡é ¼åº¦**: Low  
**æ¤œå‡ºä»¶æ•°**: 6

**èª¬æ˜**:  
SQL injection may be possible.

**å½±éŸ¿ã‚’å—ã‘ã‚‹URL**:
- http://api:5000/api/login
- http://api:5000/api/users
- http://api:5000/api/login
- http://api:5000/api/users
- http://api:5000/api/users?search=%27
- ...ä»– 1 ä»¶

**æ¨å¥¨å¯¾ç­–**:  
Do not trust client side input, even if there is client side validation in place.
In general, type check all data on the server side.
If the application uses JDBC, use PreparedStatement or CallableStatement, with parameters passed by '?'
If the application uses ASP, use ADO Command Objects with strong type checking and parameterized queries.
If database Stored Procedures can be used, use them.
Do *not* concatenate strings into queries in the stored procedure, or use 'exec', 'exec immediate', or 

---

### Medium ãƒªã‚¹ã‚¯

#### Missing Anti-clickjacking Header

**ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«**: Medium  
**ä¿¡é ¼åº¦**: Medium  
**æ¤œå‡ºä»¶æ•°**: 3

**èª¬æ˜**:  
The response does not protect against 'ClickJacking' attacks. It should include either Content-Security-Policy with 'frame-ancestors' directive or X-Frame-Options.

**å½±éŸ¿ã‚’å—ã‘ã‚‹URL**:
- http://frontend/
- http://frontend/login
- http://frontend/users/new

---

#### Content Security Policy (CSP) Header Not Set

**ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«**: Medium  
**ä¿¡é ¼åº¦**: High  
**æ¤œå‡ºä»¶æ•°**: 4

**èª¬æ˜**:  
Content Security Policy (CSP) is an added layer of security that helps to detect and mitigate certain types of attacks, including Cross Site Scripting (XSS) and data injection attacks. These attacks are used for everything from data theft to site defacement or distribution of malware. CSP provides a

**å½±éŸ¿ã‚’å—ã‘ã‚‹URL**:
- http://frontend/
- http://frontend/login
- http://frontend/users/new
- ...ä»– 1 ä»¶

---

#### Cross-Domain Misconfiguration

**ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«**: Medium  
**ä¿¡é ¼åº¦**: Medium  
**æ¤œå‡ºä»¶æ•°**: 2

**èª¬æ˜**:  
Web browser data loading may be possible, due to a Cross Origin Resource Sharing (CORS) misconfiguration on the web server.

**å½±éŸ¿ã‚’å—ã‘ã‚‹URL**:
- http://frontend/api/users
- http://frontend/api/login

---

### Low ãƒªã‚¹ã‚¯

**æ¤œå‡ºé …ç›®ä¸€è¦§**:
- Application Error Disclosure (5ä»¶)
- Cross Site Scripting Weakness (Persistent in JSON Response) (6ä»¶)
- Cross Site Scripting Weakness (Reflected in JSON Response) (4ä»¶)
- In Page Banner Information Leak (4ä»¶)
- Insufficient Site Isolation Against Spectre Vulnerability (6ä»¶)
- Permissions Policy Header Not Set (3ä»¶)
- Server Leaks Version Information via "Server" HTTP Response Header Field (4ä»¶)
- X-Content-Type-Options Header Missing (4ä»¶)
- ZAP is Out of Date (3ä»¶)

## 4. åé›†URLä¸€è¦§

**ç·URLæ•°**: 96

**ä¸»è¦ãªURL**:
- http://api:5000
- http://api:5000/api
- http://api:5000/api/files
- http://api:5000/api/files/test.txt
- http://api:5000/api/import
- http://api:5000/api/login
- http://api:5000/api/users
- http://api:5000/api/users/1
- http://api:5000/api/users?search=test
- http://api:5000/etc
- http://api:5000/etc/passwd
- http://evil.example.com
- http://evil.example.com/phishing
- http://frontend
- http://frontend/
- http://frontend/.env
- http://frontend/?redirect=.%2Fusers%2Fnew
- http://frontend/admin
- http://frontend/api
- http://frontend/api/Controllers

...ä»– 76 ä»¶ã®URLãŒåé›†ã•ã‚Œã¾ã—ãŸã€‚

## 5. Playwright ãƒ†ã‚¹ãƒˆçµæœ

Playwright E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã€ZAP ProxyçµŒç”±ã§é€šä¿¡ã‚’åé›†ã—ã¾ã—ãŸã€‚

**å®Ÿè¡Œãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ**:
- S-01: åˆæœŸã‚¢ã‚¯ã‚»ã‚¹ & ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
- S-02: ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ & æ¤œç´¢
- S-03: ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆï¼ˆæ­£å¸¸ç³»ï¼‰
- S-04: ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆï¼ˆç•°å¸¸ç³»ï¼‰
- S-05: ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°è¡¨ç¤º

è©³ç´°ãªãƒ†ã‚¹ãƒˆçµæœã¯ `/docker-work-dir/e2e-reports/` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## 6. Ajax Spider å®Ÿè¡Œçµæœ

| é …ç›® | å€¤ |
|------|-----|
| Firefox ESR ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | Firefox ESR 115.xï¼ˆãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ãƒ¢ãƒ¼ãƒ‰ï¼‰ |
| Ajax Spider ç™ºè¦‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•° | 180 |
| Ajax Spider å¾Œã®ç·URLæ•° | 96 |
| Ajax Spider å®Ÿè¡Œã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | stoppedï¼ˆæ­£å¸¸å®Œäº†ï¼‰ |

Ajax Spiderã«ã‚ˆã‚Šã€Playwrightãƒ†ã‚¹ãƒˆã§ã¯åˆ°é”ã§ããªã‹ã£ãŸã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã®
URLã‚„JavaScriptãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãŒè¿½åŠ ã§ç™ºè¦‹ã•ã‚Œã¾ã—ãŸã€‚

## 7. å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ« | ãƒ‘ã‚¹ |
|---------|------|
| ZAP HTML ãƒ¬ãƒãƒ¼ãƒˆ | `/reports/zap-active/zap-active-report.html` |
| ZAP JSON ãƒ¬ãƒãƒ¼ãƒˆ | `/reports/zap-active/zap-active-report.json` |
| å…¨ã‚¢ãƒ©ãƒ¼ãƒˆ JSON | `/reports/zap-active/all-alerts.json` |
| åé›†URLä¸€è¦§ | `/reports/zap-active/collected-urls.json` |
| é€šä¿¡åé›†ãƒ•ã‚§ãƒ¼ã‚ºã‚¢ãƒ©ãƒ¼ãƒˆ | `/reports/zap-active/active-scan-alerts.json` |

## 8. é‡è¦ãªæ¤œå‡ºäº‹é …

### ğŸ”´ Critical: SQL Injection æ¤œå‡º

**å½±éŸ¿ç¯„å›²**: `http://api:5000/api/login`

SQL Injection è„†å¼±æ€§ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸã€‚ã“ã‚Œã¯æœ€ã‚‚æ·±åˆ»ãªè„†å¼±æ€§ã®1ã¤ã§ã‚ã‚Šã€
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ã€ãƒ‡ãƒ¼ã‚¿æ¼æ´©ã€ãƒ‡ãƒ¼ã‚¿æ”¹ã–ã‚“ã€ã‚µãƒ¼ãƒ“ã‚¹åœæ­¢ãªã©ã®
é‡å¤§ãªå½±éŸ¿ã‚’åŠã¼ã™å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

**å³åº§ã«å¯¾ç­–ãŒå¿…è¦ã§ã™**:
- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã‚¯ã‚¨ãƒªï¼ˆPrepared Statementsï¼‰ã®ä½¿ç”¨
- å…¥åŠ›å€¤ã®å³æ ¼ãªãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- ORMï¼ˆEntity Frameworkç­‰ï¼‰ã®æ­£ã—ã„ä½¿ç”¨
- æœ€å°æ¨©é™ã®åŸå‰‡ã«åŸºã¥ãDBæ¨©é™è¨­å®š

### âš ï¸ Medium: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®ä¸è¶³

ä»¥ä¸‹ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“:
- Content Security Policy (CSP)
- X-Frame-Options (ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°å¯¾ç­–)

ã“ã‚Œã‚‰ã¯ XSS ã‚„ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°æ”»æ’ƒã®ãƒªã‚¹ã‚¯ã‚’é«˜ã‚ã¾ã™ã€‚

## 9. æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **å³æ™‚å¯¾å¿œãŒå¿…è¦**: SQL Injection è„†å¼±æ€§ã®ä¿®æ­£
2. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®è¿½åŠ **: CSP, X-Frame-Options ã®è¨­å®š
3. **Cookieå±æ€§ã®å¼·åŒ–**: SameSite å±æ€§ã®è¨­å®š
4. **è©³ç´°èª¿æŸ»**: å…¨ã‚¢ãƒ©ãƒ¼ãƒˆã®æ¤œè¨¼ã¨ false positive ã®é™¤å¤–

---

**ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ**: OWASP ZAP 2.16.1  
**å®Ÿæ–½è€…**: ZAP Active Scan Agent  
