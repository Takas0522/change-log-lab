# E2E テスト（OWASP ZAP パッシブスキャン用）

OWASP ZAP パッシブスキャンのための Playwright E2E テストプロジェクトです。

## 概要

ZAP を Proxy モードで起動し、このテストスイートがブラウザを通じてアプリケーションの全機能を操作します。
通過する全 HTTP 通信が ZAP に記録され、パッシブ/アクティブスキャンの対象となります。

## ディレクトリ構成

```
src/e2e/
├── package.json              # 依存パッケージ定義
├── playwright.config.ts      # Playwright 設定（ZAP Proxy 経由）
├── README.md                 # このファイル
└── tests/                    # テストファイル（エージェント自動生成）
    ├── helpers.ts            # 共通ヘルパー関数
    ├── smoke.spec.ts         # スモークテスト
    └── s*.spec.ts            # 各シナリオテスト
```

## 使用方法

### scanner コンテナ内での実行

```bash
# E2E テストを ZAP Proxy 経由で実行
cd /tmp/e2e-run
ZAP_PROXY=http://localhost:8090 npx playwright test
```

### 環境変数

| 変数 | デフォルト | 説明 |
|------|-----------|------|
| `FRONTEND_URL` | `http://frontend:80` | フロントエンド URL |
| `API_URL` | `http://api:5000` | API URL |
| `ZAP_PROXY` | `http://localhost:8090` | ZAP Proxy アドレス |

## エージェント連携

このプロジェクトは以下のエージェントと連携して使用されます:

1. **zap-passive-scenario** — シナリオ文書を作成
2. **zap-passive-codegen** — シナリオからテストコードを生成
3. **zap-passive-scan** — ZAP + Playwright でスキャン実行
4. **zap-passive-orchestrator** — 上記3工程を統括
